<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="_unit_8cs" kind="file">
    <compoundname>Unit.cs</compoundname>
    <innerclass refid="class_unit" prot="public">Unit</innerclass>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="keyword">using</highlight><highlight class="normal"><sp/>System;</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>System.Collections;</highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>System.Collections.Generic;</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>UnityEngine;</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>UnityEngine.UI;</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7" refid="class_unit" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="class_unit" kindref="compound">Unit</ref><sp/>:<sp/>MonoBehaviour</highlight></codeline>
<codeline lineno="8"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9" refid="class_unit_1ac2845ad114f1c3b932f23dedad85ce9e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action<sp/><ref refid="class_unit_1ac2845ad114f1c3b932f23dedad85ce9e" kindref="member">OnAnyUnitDeath</ref>;</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11" refid="class_unit_1ae64583504b6d818650d5b48ab1b26614" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[HideInInspector]<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="class_unit_position" kindref="compound">UnitPosition</ref><sp/><ref refid="class_unit_1ae64583504b6d818650d5b48ab1b26614" kindref="member">TargetMovePositionObject</ref>;</highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight></codeline>
<codeline lineno="13" refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[HideInInspector]<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="class_squad" kindref="compound">Squad</ref><sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>;</highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15" refid="class_unit_1a2df246b2bea37814ea10247809fa5e9f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/><ref refid="class_unit_position" kindref="compound">UnitPosition</ref><sp/><ref refid="class_unit_1a2df246b2bea37814ea10247809fa5e9f" kindref="member">unitPosOriginal</ref>;</highlight></codeline>
<codeline lineno="16" refid="class_unit_1a24c4e2364b3728bad6c9c8d59eed1d67" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>GameObject<sp/><ref refid="class_unit_1a24c4e2364b3728bad6c9c8d59eed1d67" kindref="member">DroppedItemOriginal</ref>;</highlight></codeline>
<codeline lineno="17" refid="class_unit_1a934c70f47e775cc45f8deaed4166edf6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>Transform<sp/><ref refid="class_unit_1a934c70f47e775cc45f8deaed4166edf6" kindref="member">DroppedItemsContainer</ref>;</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight></codeline>
<codeline lineno="19" refid="class_unit_1a0d8010385c2c2ad1e85011125513d37c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[Space]<sp/>[SerializeField]<sp/>Transform<sp/><ref refid="class_unit_1a0d8010385c2c2ad1e85011125513d37c" kindref="member">shadow</ref>;</highlight></codeline>
<codeline lineno="20" refid="class_unit_1a8b7a9c5d8a4bee4ef8f040e92f0b34fd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>GameObject<sp/><ref refid="class_unit_1a8b7a9c5d8a4bee4ef8f040e92f0b34fd" kindref="member">Shadow</ref><sp/>{<sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>shadow.gameObject;<sp/>}<sp/>}</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22" refid="class_unit_1ac0ce6ed523ca0dd717c8cc0bde465fcc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;GameObject&gt;<sp/><ref refid="class_unit_1ac0ce6ed523ca0dd717c8cc0bde465fcc" kindref="member">OnArmsChanged</ref>;</highlight></codeline>
<codeline lineno="23" refid="class_unit_1aac1f5a22622125673575c668cc4a456a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[Space]<sp/>[SerializeField]<sp/>GameObject<sp/><ref refid="class_unit_1aac1f5a22622125673575c668cc4a456a" kindref="member">arms</ref>;</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>GameObject<sp/><ref refid="class_unit_1a763073471f02015e11f355ed655dc571" kindref="member">Arms</ref></highlight></codeline>
<codeline lineno="25" refid="class_unit_1a763073471f02015e11f355ed655dc571" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aac1f5a22622125673575c668cc4a456a" kindref="member">arms</ref>;<sp/>}</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set<sp/>{<sp/><ref refid="class_unit_1aac1f5a22622125673575c668cc4a456a" kindref="member">arms</ref><sp/>=<sp/>value;<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ac0ce6ed523ca0dd717c8cc0bde465fcc" kindref="member">OnArmsChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1ac0ce6ed523ca0dd717c8cc0bde465fcc" kindref="member">OnArmsChanged</ref>(<ref refid="class_unit_1aac1f5a22622125673575c668cc4a456a" kindref="member">arms</ref>);<sp/>}</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30" refid="class_unit_1a3c4bd55aba65109a706c5f6933f40801" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;GameObject&gt;<sp/><ref refid="class_unit_1a3c4bd55aba65109a706c5f6933f40801" kindref="member">OnLegsChanged</ref>;</highlight></codeline>
<codeline lineno="31" refid="class_unit_1ab3cbf6327244f367e3333b829cef2c60" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>GameObject<sp/><ref refid="class_unit_1ab3cbf6327244f367e3333b829cef2c60" kindref="member">legs</ref>;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>GameObject<sp/><ref refid="class_unit_1a259a436f935f4d34bebd348139262181" kindref="member">Legs</ref></highlight></codeline>
<codeline lineno="33" refid="class_unit_1a259a436f935f4d34bebd348139262181" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ab3cbf6327244f367e3333b829cef2c60" kindref="member">legs</ref>;<sp/>}</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set<sp/>{<sp/><ref refid="class_unit_1ab3cbf6327244f367e3333b829cef2c60" kindref="member">legs</ref><sp/>=<sp/>value;<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a3c4bd55aba65109a706c5f6933f40801" kindref="member">OnLegsChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1a3c4bd55aba65109a706c5f6933f40801" kindref="member">OnLegsChanged</ref>(<ref refid="class_unit_1ab3cbf6327244f367e3333b829cef2c60" kindref="member">legs</ref>);<sp/>}</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>[Space]</highlight></codeline>
<codeline lineno="39" refid="class_unit_1ad9874966b06e1c4eee55a335d2aa611e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>GameObject<sp/><ref refid="class_unit_1ad9874966b06e1c4eee55a335d2aa611e" kindref="member">arms_with_spear</ref>;</highlight></codeline>
<codeline lineno="40" refid="class_unit_1a2779427842436e81c3aaf60a656756a6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>GameObject<sp/><ref refid="class_unit_1a2779427842436e81c3aaf60a656756a6" kindref="member">arms_with_sword</ref>;</highlight></codeline>
<codeline lineno="41" refid="class_unit_1acdc0f0874a0e00574a1c8997757534ab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>GameObject<sp/><ref refid="class_unit_1acdc0f0874a0e00574a1c8997757534ab" kindref="member">arms_with_pike</ref>;</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref></highlight></codeline>
<codeline lineno="44" refid="class_unit_1aa9485f087a4a27b827435b20a5325770" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stats.Health;<sp/>}</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>oldVal<sp/>=<sp/>stats.Health;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stats.Health<sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a05fc936d5804f3cedb391dc79a4f256f" kindref="member">OnHealthChanged</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a67533dd4d7786030e65c7548c751c407" kindref="member">DrawUnitHp</ref>);</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.SquadHealth<sp/>-=<sp/>oldVal<sp/>-<sp/>stats.Health;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1ab53484f4715c9dbe92dbdc920dbd755f" kindref="member">Health</ref><sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a668a8b3411432237b13db3c5a9d768d6" kindref="member">Death</ref>();</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>[Header(</highlight><highlight class="stringliteral">&quot;Unit<sp/>default<sp/>properties<sp/>(will<sp/>set<sp/>by<sp/>squad)&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="61" refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/><ref refid="struct_unit_stats" kindref="compound">UnitStats</ref><sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>;</highlight></codeline>
<codeline lineno="62" refid="class_unit_1a45c42ced508cd035199cbfd52ebf62f0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/><ref refid="struct_unit_stats" kindref="compound">UnitStats</ref><sp/><ref refid="class_unit_1a45c42ced508cd035199cbfd52ebf62f0" kindref="member">Stats</ref><sp/>{<sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>;<sp/>}<sp/>}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>[Header(</highlight><highlight class="stringliteral">&quot;Unit<sp/>current<sp/>properties&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]</highlight></codeline>
<codeline lineno="66" refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref><sp/>=<sp/>100;</highlight></codeline>
<codeline lineno="67" refid="class_unit_1a634cbff3ef8348517936a486a0796883" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a634cbff3ef8348517936a486a0796883" kindref="member">CurrentSpeed</ref><sp/>{<sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref>;<sp/>}<sp/>}</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>[Header(</highlight><highlight class="stringliteral">&quot;Unit<sp/>independent<sp/>properties&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>[Tooltip(</highlight><highlight class="stringliteral">&quot;Радиус<sp/>вогруг<sp/>точки,<sp/>в<sp/>которую<sp/>движется<sp/>юнит,<sp/>при<sp/>попадении<sp/>в<sp/>который,<sp/>юнит<sp/>перестанет<sp/>пытаться<sp/>идти<sp/>дальше.&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="71" refid="class_unit_1a618029083fa135eccf86ff424be8fea5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a618029083fa135eccf86ff424be8fea5" kindref="member">movingRange</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="72" refid="class_unit_1a6fa9dcf5a65ffec0ed3cea98800e2d98" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a6fa9dcf5a65ffec0ed3cea98800e2d98" kindref="member">MovingRange</ref><sp/>{<sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a618029083fa135eccf86ff424be8fea5" kindref="member">movingRange</ref>;<sp/>}<sp/>}</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/>[Tooltip(</highlight><highlight class="stringliteral">&quot;Сектор,<sp/>при<sp/>попадении<sp/>поворота<sp/>юнита<sp/>в<sp/>который,<sp/>он<sp/>перестанет<sp/>пытаться<sp/>поворачиваться.&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="74" refid="class_unit_1ae3bb39d00c9bdf1aaaaca1752dfebbd7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae3bb39d00c9bdf1aaaaca1752dfebbd7" kindref="member">rotationRange</ref><sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="75" refid="class_unit_1a427d6b7cdb646d9ec715f08b5350b276" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a427d6b7cdb646d9ec715f08b5350b276" kindref="member">RotationRange</ref><sp/>{<sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae3bb39d00c9bdf1aaaaca1752dfebbd7" kindref="member">rotationRange</ref>;<sp/>}<sp/>}</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>[Space]</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>[Tooltip(</highlight><highlight class="stringliteral">&quot;Длина<sp/>области<sp/>пространства,<sp/>в<sp/>которой<sp/>будут<sp/>определятся<sp/>цель.&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="78" refid="class_unit_1a2fb4a37c1323b2f767974c275137e96a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>1)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a2fb4a37c1323b2f767974c275137e96a" kindref="member">attackLineLength</ref><sp/>=<sp/>0.5f;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>[Tooltip(</highlight><highlight class="stringliteral">&quot;Ширина<sp/>области<sp/>пространства,<sp/>в<sp/>которой<sp/>будут<sp/>определятся<sp/>цель.&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="80" refid="class_unit_1a17a709112cadd05f397d9f0de0bc8cbe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>1)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a17a709112cadd05f397d9f0de0bc8cbe" kindref="member">attackLineWidth</ref><sp/>=<sp/>0.2f;</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>[Space]</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>[Tooltip(</highlight><highlight class="stringliteral">&quot;Когда<sp/>юнит<sp/>получает<sp/>урон,<sp/>он<sp/>будет<sp/>застанет<sp/>на<sp/>данный<sp/>промежуток<sp/>времени.&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="83" refid="class_unit_1a64c1b3b029850374cbfd9480a89a9dde" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>5)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a64c1b3b029850374cbfd9480a89a9dde" kindref="member">delayAfterTakingDamage</ref><sp/>=<sp/>1f;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/>[Tooltip(</highlight><highlight class="stringliteral">&quot;Когда<sp/>юнит<sp/>толкает<sp/>союзника,<sp/>он<sp/>будет<sp/>застанет<sp/>на<sp/>данный<sp/>промежуток<sp/>времени.&quot;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="85" refid="class_unit_1a1daaf9112d09b011eba7489f681c0bde" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>5)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a1daaf9112d09b011eba7489f681c0bde" kindref="member">delayAfterPushingAlly</ref><sp/>=<sp/>0.2f;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/>[Space]</highlight></codeline>
<codeline lineno="87" refid="class_unit_1ab104d1bd779a6d80939b314504f84680" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>5)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ab104d1bd779a6d80939b314504f84680" kindref="member">findTargetDeltaTime</ref><sp/>=<sp/>0.2f;</highlight></codeline>
<codeline lineno="88" refid="class_unit_1a6c2a41380ef9b7baf0470d915fad494f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>5)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a6c2a41380ef9b7baf0470d915fad494f" kindref="member">attacInRanksDeltaTime</ref><sp/>=<sp/>1f;</highlight></codeline>
<codeline lineno="89" refid="class_unit_1a65bedc95f047dd664f0930360e987d4a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>5)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a65bedc95f047dd664f0930360e987d4a" kindref="member">attacInPhalanxDeltaTime</ref><sp/>=<sp/>0.5f;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/>[Space]</highlight></codeline>
<codeline lineno="91" refid="class_unit_1acee1f097d1eb5b20d4e736cc6afd3195" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>180)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1acee1f097d1eb5b20d4e736cc6afd3195" kindref="member">frontPushingAngleException</ref><sp/>=<sp/>40;</highlight></codeline>
<codeline lineno="92" refid="class_unit_1ac9f015542720f3afb5115e40dd96bfbe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>360)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ac9f015542720f3afb5115e40dd96bfbe" kindref="member">pushingAngle</ref><sp/>=<sp/>40;</highlight></codeline>
<codeline lineno="93" refid="class_unit_1a6e26511ceba3f6e0734bd926eb387abe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>360)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a6e26511ceba3f6e0734bd926eb387abe" kindref="member">chargePpushingAngle</ref><sp/>=<sp/>120;</highlight></codeline>
<codeline lineno="94" refid="class_unit_1a6a103535cb0664025d482523d10a5b5b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[SerializeField]<sp/>[Range(0,<sp/>90)]<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a6a103535cb0664025d482523d10a5b5b" kindref="member">weaponAngleDeviation</ref><sp/>=<sp/>10;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96" refid="class_unit_1a74d4b7ecb179aeb14b1d444464e097f0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Rigidbody2D<sp/><ref refid="class_unit_1a74d4b7ecb179aeb14b1d444464e097f0" kindref="member">rigidbody2D</ref>;</highlight></codeline>
<codeline lineno="97" refid="class_unit_1a1bf848f0dfcd8f7e1e410c9e7f8da7c8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>CircleCollider2D<sp/><ref refid="class_unit_1a1bf848f0dfcd8f7e1e410c9e7f8da7c8" kindref="member">circleCollider2D</ref>;</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="class_unit_1add2aa3b639fc62419506ff89e504421e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>GameObject<sp/><ref refid="class_unit_1add2aa3b639fc62419506ff89e504421e" kindref="member">selection</ref>;</highlight></codeline>
<codeline lineno="100" refid="class_unit_1a7a8db9366b9e2e6fdd1b33ed8074cf0c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>SpriteRenderer<sp/><ref refid="class_unit_1a7a8db9366b9e2e6fdd1b33ed8074cf0c" kindref="member">selectionRenderer</ref>;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102" refid="class_unit_1a8334983a56e9eff377bc3f0257308f65" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a8334983a56e9eff377bc3f0257308f65" kindref="member">selected</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4aa7e5de646cca24872f72e9aa0752ed" kindref="member">Selected</ref></highlight></codeline>
<codeline lineno="104" refid="class_unit_1a4aa7e5de646cca24872f72e9aa0752ed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a8334983a56e9eff377bc3f0257308f65" kindref="member">selected</ref>;<sp/>}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>set</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gameObject.layer<sp/>==<sp/>LayerMask.NameToLayer(<ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1abe71578ac0516480f581c7011b1a3ea5" kindref="member">UnitFraction</ref>.ALLY.ToString()))</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a8334983a56e9eff377bc3f0257308f65" kindref="member">selected</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selection.SetActive(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gameObject.layer<sp/>==<sp/>LayerMask.NameToLayer(<ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1abe71578ac0516480f581c7011b1a3ea5" kindref="member">UnitFraction</ref>.ENEMY.ToString()))</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a8334983a56e9eff377bc3f0257308f65" kindref="member">selected</ref><sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selection.SetActive(value);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a8334983a56e9eff377bc3f0257308f65" kindref="member">selected</ref><sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selection.SetActive(value);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight></codeline>
<codeline lineno="126" refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" kindref="member">stanned</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="127" refid="class_unit_1a83b2b8b38fda57ac2df8d8c61492b74e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a83b2b8b38fda57ac2df8d8c61492b74e" kindref="member">Stanned</ref><sp/>{<sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" kindref="member">stanned</ref>;<sp/>}<sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129" refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Transform<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref><sp/>{<sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal">;<sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set;<sp/>}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"></highlight></codeline>
<codeline lineno="131" refid="class_unit_1a90ba6a64ce6b06b19746be8c24694007" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>Transform<sp/><ref refid="class_unit_1a90ba6a64ce6b06b19746be8c24694007" kindref="member">startRay</ref>;</highlight></codeline>
<codeline lineno="132" refid="class_unit_1ad6bf077ca76b0d31861c3ef0229bc1d7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>Transform<sp/><ref refid="class_unit_1ad6bf077ca76b0d31861c3ef0229bc1d7" kindref="member">endRay</ref>;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"></highlight></codeline>
<codeline lineno="134" refid="class_unit_1ab3ca7ac097c387092dae0a7e9678401f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ab3ca7ac097c387092dae0a7e9678401f" kindref="member">currentAttackDeltaTime</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="135" refid="class_unit_1aecfa6ef8287ba34e580703fabf6f4961" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aecfa6ef8287ba34e580703fabf6f4961" kindref="member">unionCheckDeltatime</ref><sp/>=<sp/>0.5f;</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137" refid="class_unit_1a9c15dea36c4d86be4bc211d93cab17b9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a9c15dea36c4d86be4bc211d93cab17b9" kindref="member">rHitLayerEnemy</ref>;</highlight></codeline>
<codeline lineno="138" refid="class_unit_1a44760b3254e2485581a6795c01b92688" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>RaycastHit2D<sp/><ref refid="class_unit_1a44760b3254e2485581a6795c01b92688" kindref="member">rHit</ref>;</highlight></codeline>
<codeline lineno="139" refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_unit" kindref="compound">Unit</ref><sp/><ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref>;</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="144" refid="class_unit_1ae61f57dcc4db8900d0aed2a2818480f5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae61f57dcc4db8900d0aed2a2818480f5" kindref="member">takeHit</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight></codeline>
<codeline lineno="146" refid="class_unit_1a863e154dca485b1d4b377007afa91347" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>Vector2<sp/><ref refid="class_unit_1a8337ffe9ca75b8cb45b549545b9478c5" kindref="member">v1</ref>,<sp/><ref refid="class_unit_1a863e154dca485b1d4b377007afa91347" kindref="member">v2</ref>;</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148" refid="class_unit_1af494ffc0a4b39c61ee443b03021f54cc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;GameObject&gt;<sp/><ref refid="class_unit_1af494ffc0a4b39c61ee443b03021f54cc" kindref="member">OnHelmetChanged</ref>;</highlight></codeline>
<codeline lineno="149" refid="class_unit_1a6ec7235039f62e2f55872b95424a1f19" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>GameObject<sp/><ref refid="class_unit_1a6ec7235039f62e2f55872b95424a1f19" kindref="member">_helmet</ref>;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>GameObject<sp/><ref refid="class_unit_1aed3b83c80208b0da9bc42633e01f3801" kindref="member">Helmet</ref></highlight></codeline>
<codeline lineno="151" refid="class_unit_1aed3b83c80208b0da9bc42633e01f3801" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a6ec7235039f62e2f55872b95424a1f19" kindref="member">_helmet</ref>;<sp/>}</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set<sp/>{<sp/><ref refid="class_unit_1a6ec7235039f62e2f55872b95424a1f19" kindref="member">_helmet</ref><sp/>=<sp/>value;<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1af494ffc0a4b39c61ee443b03021f54cc" kindref="member">OnHelmetChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1af494ffc0a4b39c61ee443b03021f54cc" kindref="member">OnHelmetChanged</ref>(<ref refid="class_unit_1a6ec7235039f62e2f55872b95424a1f19" kindref="member">_helmet</ref>);<sp/>}</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="155" refid="class_unit_1a9d599d97ac49cb583b6f0d1763c5cecf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_equipment" kindref="compound">Equipment</ref><sp/><ref refid="class_unit_1a9d599d97ac49cb583b6f0d1763c5cecf" kindref="member">helmet</ref>;</highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight></codeline>
<codeline lineno="157" refid="class_unit_1a9cb3fadb0988d527c23d86b0fda58b5d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;GameObject&gt;<sp/><ref refid="class_unit_1a9cb3fadb0988d527c23d86b0fda58b5d" kindref="member">OnBodyChanged</ref>;</highlight></codeline>
<codeline lineno="158" refid="class_unit_1a2bb6b34951186e8eed3725aa4b207192" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>GameObject<sp/><ref refid="class_unit_1a2bb6b34951186e8eed3725aa4b207192" kindref="member">_body</ref>;</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>GameObject<sp/><ref refid="class_unit_1a8c29ddac1642c3fe9b293dfdbc7eaccf" kindref="member">Body</ref></highlight></codeline>
<codeline lineno="160" refid="class_unit_1a8c29ddac1642c3fe9b293dfdbc7eaccf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a2bb6b34951186e8eed3725aa4b207192" kindref="member">_body</ref>;<sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set<sp/>{<sp/><ref refid="class_unit_1a2bb6b34951186e8eed3725aa4b207192" kindref="member">_body</ref><sp/>=<sp/>value;<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a9cb3fadb0988d527c23d86b0fda58b5d" kindref="member">OnBodyChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1a9cb3fadb0988d527c23d86b0fda58b5d" kindref="member">OnBodyChanged</ref>(<ref refid="class_unit_1a2bb6b34951186e8eed3725aa4b207192" kindref="member">_body</ref>);<sp/>}</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="164" refid="class_unit_1ac5cd40c1443543628fd9739b96d81d96" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_equipment" kindref="compound">Equipment</ref><sp/><ref refid="class_unit_1ac5cd40c1443543628fd9739b96d81d96" kindref="member">body</ref>;</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166" refid="class_unit_1a1bccb914da1d4c72f83350c6af473a7c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;GameObject&gt;<sp/><ref refid="class_unit_1a1bccb914da1d4c72f83350c6af473a7c" kindref="member">OnShieldChanged</ref>;</highlight></codeline>
<codeline lineno="167" refid="class_unit_1a82360860f8558503cabc588124e69565" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>GameObject<sp/><ref refid="class_unit_1a82360860f8558503cabc588124e69565" kindref="member">_shield</ref>;</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>GameObject<sp/><ref refid="class_unit_1ac5118086252debc28d4ce9b1676b003c" kindref="member">Shield</ref></highlight></codeline>
<codeline lineno="169" refid="class_unit_1ac5118086252debc28d4ce9b1676b003c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a82360860f8558503cabc588124e69565" kindref="member">_shield</ref>;<sp/>}</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set<sp/>{<sp/><ref refid="class_unit_1a82360860f8558503cabc588124e69565" kindref="member">_shield</ref><sp/>=<sp/>value;<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a1bccb914da1d4c72f83350c6af473a7c" kindref="member">OnShieldChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1a1bccb914da1d4c72f83350c6af473a7c" kindref="member">OnShieldChanged</ref>(<ref refid="class_unit_1a82360860f8558503cabc588124e69565" kindref="member">_shield</ref>);<sp/>}</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="173" refid="class_unit_1ab794b52831585c67e9e88c021ac7739c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_equipment" kindref="compound">Equipment</ref><sp/><ref refid="class_unit_1ab794b52831585c67e9e88c021ac7739c" kindref="member">shield</ref>;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175" refid="class_unit_1aec8db1ef09aed76aa3dc607506c6ced4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;GameObject&gt;<sp/><ref refid="class_unit_1aec8db1ef09aed76aa3dc607506c6ced4" kindref="member">OnWeaponChanged</ref>;</highlight></codeline>
<codeline lineno="176" refid="class_unit_1aece1199b96472d9492a027455a03d4df" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>GameObject<sp/><ref refid="class_unit_1aece1199b96472d9492a027455a03d4df" kindref="member">_weapon</ref>;</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>GameObject<sp/><ref refid="class_unit_1a1c1d598622fce50f66ba18df1c968783" kindref="member">Weapon</ref></highlight></codeline>
<codeline lineno="178" refid="class_unit_1a1c1d598622fce50f66ba18df1c968783" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aece1199b96472d9492a027455a03d4df" kindref="member">_weapon</ref>;<sp/>}</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set<sp/>{<sp/><ref refid="class_unit_1aece1199b96472d9492a027455a03d4df" kindref="member">_weapon</ref><sp/>=<sp/>value;<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1aec8db1ef09aed76aa3dc607506c6ced4" kindref="member">OnWeaponChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1aec8db1ef09aed76aa3dc607506c6ced4" kindref="member">OnWeaponChanged</ref>(<ref refid="class_unit_1aece1199b96472d9492a027455a03d4df" kindref="member">_weapon</ref>);<sp/>}</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="182" refid="class_unit_1a75f07f8acd9d08df317a88440297035e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_equipment" kindref="compound">Equipment</ref><sp/><ref refid="class_unit_1a75f07f8acd9d08df317a88440297035e" kindref="member">weapon</ref>;</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="184" refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" kindref="member">pushingAlly</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="185" refid="class_unit_1a46fef034c97d6f9f17679d02bc1c9690" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;Unit&gt;<sp/><ref refid="class_unit_1a46fef034c97d6f9f17679d02bc1c9690" kindref="member">pushedUnit</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>List&lt;Unit&gt;(3);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="190" refid="class_unit_1a95573f5c0d7610e5ef074df6c2684131" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>List&lt;Unit&gt;<sp/><ref refid="class_unit_1a95573f5c0d7610e5ef074df6c2684131" kindref="member">targettedBy</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>List&lt;Unit&gt;(5);</highlight></codeline>
<codeline lineno="191" refid="class_unit_1a5f06967732cecb0a195a9e0085f752a6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a5f06967732cecb0a195a9e0085f752a6" kindref="member">attaking</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="192" refid="class_unit_1a93cdc599aa3a1f72faccfc235b2931d7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a93cdc599aa3a1f72faccfc235b2931d7" kindref="member">olreadyNotPushingAlly</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight></codeline>
<codeline lineno="194" refid="class_unit_1abeace1ab14346ab2514c45d3a36f6878" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1abeace1ab14346ab2514c45d3a36f6878" kindref="member">timerForAttack</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="195" refid="class_unit_1a6260feff14d941446a49739bb497710e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a6260feff14d941446a49739bb497710e" kindref="member">timerForFindTarget</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="196" refid="class_unit_1a61fb8d0ee5274d873330f1ccf161e4ab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a61fb8d0ee5274d873330f1ccf161e4ab" kindref="member">timerPushingAlly</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="197" refid="class_unit_1ae104b10a3d6d2fede6b2640ebbf26002" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae104b10a3d6d2fede6b2640ebbf26002" kindref="member">timerForUnion</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199" refid="class_unit_1a6a38031756ba6764be4e5a5273f1d1c4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;bool&gt;<sp/><ref refid="class_unit_1a6a38031756ba6764be4e5a5273f1d1c4" kindref="member">OnRunValueChanged</ref>;</highlight></codeline>
<codeline lineno="200" refid="class_unit_1ab489eaf8d0174b8e8ecdc11d15054d9e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ab489eaf8d0174b8e8ecdc11d15054d9e" kindref="member">running</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref></highlight></codeline>
<codeline lineno="202" refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ab489eaf8d0174b8e8ecdc11d15054d9e" kindref="member">running</ref>;<sp/>}</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab489eaf8d0174b8e8ecdc11d15054d9e" kindref="member">running</ref><sp/>!=<sp/>value)</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab489eaf8d0174b8e8ecdc11d15054d9e" kindref="member">running</ref><sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a6a38031756ba6764be4e5a5273f1d1c4" kindref="member">OnRunValueChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1a6a38031756ba6764be4e5a5273f1d1c4" kindref="member">OnRunValueChanged</ref>(<ref refid="class_unit_1ab489eaf8d0174b8e8ecdc11d15054d9e" kindref="member">running</ref>);</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214" refid="class_unit_1a3c279e1f2acf7e92cde0b99b0e6941cf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;bool&gt;<sp/><ref refid="class_unit_1a3c279e1f2acf7e92cde0b99b0e6941cf" kindref="member">OnChargingValueChanged</ref>;</highlight></codeline>
<codeline lineno="215" refid="class_unit_1a916167975383b9b3023fe00c1b3aea36" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a916167975383b9b3023fe00c1b3aea36" kindref="member">charging</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" kindref="member">Charging</ref></highlight></codeline>
<codeline lineno="217" refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a916167975383b9b3023fe00c1b3aea36" kindref="member">charging</ref>;<sp/>}</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a916167975383b9b3023fe00c1b3aea36" kindref="member">charging</ref><sp/>!=<sp/>value)</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a916167975383b9b3023fe00c1b3aea36" kindref="member">charging</ref><sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a3c279e1f2acf7e92cde0b99b0e6941cf" kindref="member">OnChargingValueChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1a3c279e1f2acf7e92cde0b99b0e6941cf" kindref="member">OnChargingValueChanged</ref>(<ref refid="class_unit_1a916167975383b9b3023fe00c1b3aea36" kindref="member">charging</ref>);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228" refid="class_unit_1abedaa5565c0bd0a48588b931171fd5ae" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>Quaternion<sp/><ref refid="class_unit_1abedaa5565c0bd0a48588b931171fd5ae" kindref="member">chargeRotation</ref>;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230" refid="class_unit_1ad02ba5df8a551a6bbaff1151b3c029f5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ad02ba5df8a551a6bbaff1151b3c029f5" kindref="member">normLayer</ref>;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="236" refid="class_unit_1a4c74f2a22e862f3d5cf86c642a12a095" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>[NonSerialized]<sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4c74f2a22e862f3d5cf86c642a12a095" kindref="member">delayToFindTargetAndAttack</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238" refid="class_unit_1a4f755f70d4f6aaf15dc70ce0a745ac08" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action<sp/><ref refid="class_unit_1a4f755f70d4f6aaf15dc70ce0a745ac08" kindref="member">AfterInitiate</ref>;</highlight></codeline>
<codeline lineno="239" refid="class_unit_1abefc4c41f063c2fab502c47ae7794967" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action<sp/><ref refid="class_unit_1abefc4c41f063c2fab502c47ae7794967" kindref="member">OnUnitDeath</ref>;</highlight></codeline>
<codeline lineno="240"><highlight class="normal"></highlight></codeline>
<codeline lineno="244" refid="class_unit_1a03130f8a9df2424fdf47d86ca31891fe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">event</highlight><highlight class="normal"><sp/>Action&lt;bool&gt;<sp/><ref refid="class_unit_1a03130f8a9df2424fdf47d86ca31891fe" kindref="member">OnHitChanged</ref>;</highlight></codeline>
<codeline lineno="245" refid="class_unit_1ae401f3d9770fcbab8f45fdd088c457c1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae401f3d9770fcbab8f45fdd088c457c1" kindref="member">hit</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a59672cb37571acc783f8cb950fa9b501" kindref="member">Hit</ref></highlight></codeline>
<codeline lineno="247" refid="class_unit_1a59672cb37571acc783f8cb950fa9b501" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">get</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae401f3d9770fcbab8f45fdd088c457c1" kindref="member">hit</ref>;<sp/>}</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>set<sp/>{<sp/><ref refid="class_unit_1ae401f3d9770fcbab8f45fdd088c457c1" kindref="member">hit</ref><sp/>=<sp/>value;<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a03130f8a9df2424fdf47d86ca31891fe" kindref="member">OnHitChanged</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1a03130f8a9df2424fdf47d86ca31891fe" kindref="member">OnHitChanged</ref>(<ref refid="class_unit_1ae401f3d9770fcbab8f45fdd088c457c1" kindref="member">hit</ref>);<sp/>}</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252" refid="class_unit_1aa5d760cd67e37717756deebe958d70ae" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aa5d760cd67e37717756deebe958d70ae" kindref="member">Awake</ref>()</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae64583504b6d818650d5b48ab1b26614" kindref="member">TargetMovePositionObject</ref><sp/>=<sp/>Instantiate(<ref refid="class_unit_1a2df246b2bea37814ea10247809fa5e9f" kindref="member">unitPosOriginal</ref>);</highlight></codeline>
<codeline lineno="255"><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref><sp/>=<sp/>transform;</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a74d4b7ecb179aeb14b1d444464e097f0" kindref="member">rigidbody2D</ref><sp/>=<sp/>GetComponent&lt;Rigidbody2D&gt;();</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a1bf848f0dfcd8f7e1e410c9e7f8da7c8" kindref="member">circleCollider2D</ref><sp/>=<sp/>GetComponent&lt;CircleCollider2D&gt;();</highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//начало<sp/>и<sp/>конец<sp/>луча<sp/>для<sp/>атаки</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a90ba6a64ce6b06b19746be8c24694007" kindref="member">startRay</ref><sp/>=<sp/>ThisTransform.Find(</highlight><highlight class="stringliteral">&quot;StartRay&quot;</highlight><highlight class="normal">).gameObject.transform;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ad6bf077ca76b0d31861c3ef0229bc1d7" kindref="member">endRay</ref><sp/>=<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.Find(</highlight><highlight class="stringliteral">&quot;EndRay&quot;</highlight><highlight class="normal">).gameObject.transform;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1add2aa3b639fc62419506ff89e504421e" kindref="member">selection</ref><sp/>=<sp/>ThisTransform.Find(</highlight><highlight class="stringliteral">&quot;SelectionUnit&quot;</highlight><highlight class="normal">).gameObject;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a7a8db9366b9e2e6fdd1b33ed8074cf0c" kindref="member">selectionRenderer</ref><sp/>=<sp/>selection.GetComponent&lt;SpriteRenderer&gt;();</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269" refid="class_unit_1a9c1ff7b7289c2ed898bc92a0c3027058" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a9c1ff7b7289c2ed898bc92a0c3027058" kindref="member">Start</ref>()</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aa9e5811f476bcdfc35f060df91d1a110" kindref="member">Squad_OnInitiateUnitPositions</ref>();</highlight></codeline>
<codeline lineno="272"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a23be3a8485a5edfb36d928214531d070" kindref="member">SetDistanceLineForAttack</ref>();</highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rigidbody2D.bodyType<sp/>=<sp/>RigidbodyType2D.Dynamic;</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ad02ba5df8a551a6bbaff1151b3c029f5" kindref="member">normLayer</ref><sp/>=<sp/>gameObject.layer;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280" refid="class_unit_1aaf4c2806352040617d7973983ea5bee6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aaf4c2806352040617d7973983ea5bee6" kindref="member">Init</ref>()</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aa1a39b5e6d44e1b7a3ff80c484d2729d" kindref="member">SetEquipment</ref>();</highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnFormationChanged<sp/>+=<sp/><ref refid="class_unit_1ac54c63324f75df592ac77af1ed3eaefe" kindref="member">OnFormationChanged</ref>;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ac54c63324f75df592ac77af1ed3eaefe" kindref="member">OnFormationChanged</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref>);</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnDropStackFromInventory<sp/>+=<sp/><ref refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" kindref="member">OnDropStack</ref>;</highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnReformSquad<sp/>+=<sp/><ref refid="class_unit_1a91f7fe68f3b4ed2ec8b5f5418aaef5f0" kindref="member">OnReformSquad</ref>;</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a91f7fe68f3b4ed2ec8b5f5418aaef5f0" kindref="member">OnReformSquad</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref>);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnInitiateUnitPositions<sp/>+=<sp/><ref refid="class_unit_1aa9e5811f476bcdfc35f060df91d1a110" kindref="member">Squad_OnInitiateUnitPositions</ref>;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnBeginCharge<sp/>+=<sp/><ref refid="class_unit_1ac70563cf15c89e4b13b5a755518fa91f" kindref="member">Squad_OnBeginCharge</ref>;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnEndCharge<sp/>+=<sp/><ref refid="class_unit_1a3214d311c21f258c24a5962f872bcee5" kindref="member">Squad_OnEndCharge</ref>;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnDrawUnitHpChanged<sp/>+=<sp/><ref refid="class_unit_1aecd40137cf8799ee1a30a2b379615c04" kindref="member">Squad_OnDrawUnitHpChanged</ref>;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnUnitStatsChanged<sp/>+=<sp/><ref refid="class_unit_1a51874529e33dc390ecf6ff810ff9a042" kindref="member">Squad_OnUnitStatsChanged</ref>;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(gameObject.layer<sp/>!=<sp/>LayerMask.NameToLayer(<ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1abe71578ac0516480f581c7011b1a3ea5" kindref="member">UnitFraction</ref>.ENEMY.ToString()))</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4aa7e5de646cca24872f72e9aa0752ed" kindref="member">Selected</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ad02ba5df8a551a6bbaff1151b3c029f5" kindref="member">normLayer</ref><sp/>=<sp/>gameObject.layer;</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="308"><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a4f755f70d4f6aaf15dc70ce0a745ac08" kindref="member">AfterInitiate</ref><sp/>!=<sp/>null)<sp/><ref refid="class_unit_1a4f755f70d4f6aaf15dc70ce0a745ac08" kindref="member">AfterInitiate</ref>();</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312" refid="class_unit_1a668a8b3411432237b13db3c5a9d768d6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a668a8b3411432237b13db3c5a9d768d6" kindref="member">Death</ref>()</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_equipment_stack" kindref="compound">EquipmentStack</ref><sp/>stack;</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1a9d599d97ac49cb583b6f0d1763c5cecf" kindref="member">helmet</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1abd05f10096c1d46af0f13806b754118e" kindref="member">Empty</ref>)</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_equipment_stack" kindref="compound">EquipmentStack</ref>(<ref refid="class_unit_1a9d599d97ac49cb583b6f0d1763c5cecf" kindref="member">helmet</ref>);</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" kindref="member">OnDropStack</ref>(stack);</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1ac5cd40c1443543628fd9739b96d81d96" kindref="member">body</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1abd05f10096c1d46af0f13806b754118e" kindref="member">Empty</ref>)</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_equipment_stack" kindref="compound">EquipmentStack</ref>(<ref refid="class_unit_1ac5cd40c1443543628fd9739b96d81d96" kindref="member">body</ref>);</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" kindref="member">OnDropStack</ref>(stack);</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1ab794b52831585c67e9e88c021ac7739c" kindref="member">shield</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1abd05f10096c1d46af0f13806b754118e" kindref="member">Empty</ref>)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_equipment_stack" kindref="compound">EquipmentStack</ref>(<ref refid="class_unit_1ab794b52831585c67e9e88c021ac7739c" kindref="member">shield</ref>);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" kindref="member">OnDropStack</ref>(stack);</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1a75f07f8acd9d08df317a88440297035e" kindref="member">weapon</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1abd05f10096c1d46af0f13806b754118e" kindref="member">Empty</ref>)</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_equipment_stack" kindref="compound">EquipmentStack</ref>(<ref refid="class_unit_1a75f07f8acd9d08df317a88440297035e" kindref="member">weapon</ref>);</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" kindref="member">OnDropStack</ref>(stack);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cnt<sp/>=<sp/>squad.Inventory.Length;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>cnt;<sp/>i++)</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>[i]<sp/>!=<sp/>null<sp/>&amp;&amp;<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>[i].Count<sp/>&gt;<sp/>0<sp/>&amp;&amp;<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>[i].Count<sp/>&gt;=<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a14f16d0bd1098a523c721fb610247c56" kindref="member">UnitCount</ref>)</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" kindref="member">OnDropStack</ref>(</highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_equipment_stack" kindref="compound">EquipmentStack</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>[i].EquipmentMainProperties,<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>[i].EquipmentStats));</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.Inventory[i].PopItems(1);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnFormationChanged<sp/>-=<sp/><ref refid="class_unit_1ac54c63324f75df592ac77af1ed3eaefe" kindref="member">OnFormationChanged</ref>;</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnDropStackFromInventory<sp/>-=<sp/><ref refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" kindref="member">OnDropStack</ref>;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnReformSquad<sp/>-=<sp/><ref refid="class_unit_1a91f7fe68f3b4ed2ec8b5f5418aaef5f0" kindref="member">OnReformSquad</ref>;</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnInitiateUnitPositions<sp/>-=<sp/><ref refid="class_unit_1aa9e5811f476bcdfc35f060df91d1a110" kindref="member">Squad_OnInitiateUnitPositions</ref>;</highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnBeginCharge<sp/>-=<sp/><ref refid="class_unit_1ac70563cf15c89e4b13b5a755518fa91f" kindref="member">Squad_OnBeginCharge</ref>;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnEndCharge<sp/>-=<sp/><ref refid="class_unit_1a3214d311c21f258c24a5962f872bcee5" kindref="member">Squad_OnEndCharge</ref>;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnDrawUnitHpChanged<sp/>-=<sp/><ref refid="class_unit_1aecd40137cf8799ee1a30a2b379615c04" kindref="member">Squad_OnDrawUnitHpChanged</ref>;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.OnUnitStatsChanged<sp/>-=<sp/><ref refid="class_unit_1a51874529e33dc390ecf6ff810ff9a042" kindref="member">Squad_OnUnitStatsChanged</ref>;</highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//если<sp/>этот<sp/>юнит<sp/>атаковал,<sp/>то<sp/>уменьшаем<sp/>кол<sp/>во<sp/>атаковавших</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a5f06967732cecb0a195a9e0085f752a6" kindref="member">attaking</ref>)</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.AttakingUnitsCount--;</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>убираем<sp/>метку<sp/>targetted<sp/>с<sp/>цели</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target.RemoveTagrettedBy(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//ставим<sp/>всем,<sp/>кто<sp/>атаковал<sp/>этот<sp/>юнит,<sp/>цель<sp/>null<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>targettedBy.Count;<sp/>i++)</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a95573f5c0d7610e5ef074df6c2684131" kindref="member">targettedBy</ref>[i].SetTarget(null);</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i--;</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.UnitDeath(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1abefc4c41f063c2fab502c47ae7794967" kindref="member">OnUnitDeath</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1abefc4c41f063c2fab502c47ae7794967" kindref="member">OnUnitDeath</ref>();</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selection.SetActive(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Destroy(GetComponent&lt;Collider2D&gt;());</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Destroy(<ref refid="class_unit_1a74d4b7ecb179aeb14b1d444464e097f0" kindref="member">rigidbody2D</ref>);</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Destroy(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ac2845ad114f1c3b932f23dedad85ce9e" kindref="member">OnAnyUnitDeath</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ac2845ad114f1c3b932f23dedad85ce9e" kindref="member">OnAnyUnitDeath</ref>();</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392" refid="class_unit_1a51874529e33dc390ecf6ff810ff9a042" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a51874529e33dc390ecf6ff810ff9a042" kindref="member">Squad_OnUnitStatsChanged</ref>(<ref refid="struct_unit_stats" kindref="compound">UnitStats</ref><sp/>oldS,<sp/><ref refid="struct_unit_stats" kindref="compound">UnitStats</ref><sp/>newS)</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref><sp/>&gt;<sp/>newS.<ref refid="struct_unit_stats_1ab53484f4715c9dbe92dbdc920dbd755f" kindref="member">Health</ref>)</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref><sp/>=<sp/>newS.Health;</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(oldS.<ref refid="struct_unit_stats_1ab53484f4715c9dbe92dbdc920dbd755f" kindref="member">Health</ref><sp/>&lt;<sp/>newS.<ref refid="struct_unit_stats_1ab53484f4715c9dbe92dbdc920dbd755f" kindref="member">Health</ref>)</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>k<sp/>=<sp/><ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref><sp/>/<sp/>oldS.Health;</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref><sp/>=<sp/>newS.Health<sp/>*<sp/>k;</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a3e1f7a137a4b8c36c9cd775536f29685" kindref="member">SetProperties</ref>();</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405" refid="class_unit_1ac70563cf15c89e4b13b5a755518fa91f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ac70563cf15c89e4b13b5a755518fa91f" kindref="member">Squad_OnBeginCharge</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>addSpeed,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>addAcceleretion)</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" kindref="member">Charging</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1abedaa5565c0bd0a48588b931171fd5ae" kindref="member">chargeRotation</ref><sp/>=<sp/>squad.PositionsTransform.rotation;</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1abedaa5565c0bd0a48588b931171fd5ae" kindref="member">chargeRotation</ref><sp/>=<sp/>squad.FlipRotation<sp/>?<sp/><ref refid="class_unit_1abedaa5565c0bd0a48588b931171fd5ae" kindref="member">chargeRotation</ref><sp/>*<sp/>Quaternion.Euler(0,<sp/>0,<sp/>180)<sp/>:<sp/><ref refid="class_unit_1abedaa5565c0bd0a48588b931171fd5ae" kindref="member">chargeRotation</ref>;</highlight></codeline>
<codeline lineno="411"><highlight class="normal"></highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>NotImplementedException();</highlight></codeline>
<codeline lineno="413"><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//stats.Speed<sp/>*=<sp/>addSpeed;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//acceleretion<sp/>*=<sp/>addAcceleretion;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight></codeline>
<codeline lineno="418" refid="class_unit_1a3214d311c21f258c24a5962f872bcee5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a3214d311c21f258c24a5962f872bcee5" kindref="member">Squad_OnEndCharge</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>addSpeed,<sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>addAcceleretion)</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" kindref="member">Charging</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>NotImplementedException();</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//speed<sp/>/=<sp/>addSpeed;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//acceleretion<sp/>/=<sp/>addAcceleretion;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="428" refid="class_unit_1aa04424da21c32cae8e081fcfc317d31b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aa04424da21c32cae8e081fcfc317d31b" kindref="member">SetFraction</ref>(<ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1abe71578ac0516480f581c7011b1a3ea5" kindref="member">UnitFraction</ref><sp/>fraction)</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gameObject.layer<sp/>=<sp/>LayerMask.NameToLayer(fraction.ToString());</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(fraction)</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>Squad.UnitFraction.ALLY:</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a9c15dea36c4d86be4bc211d93cab17b9" kindref="member">rHitLayerEnemy</ref><sp/>=<sp/>1<sp/>&lt;&lt;<sp/>LayerMask.NameToLayer(</highlight><highlight class="stringliteral">&quot;ENEMY&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4aa7e5de646cca24872f72e9aa0752ed" kindref="member">Selected</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>Squad.UnitFraction.ENEMY:</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a9c15dea36c4d86be4bc211d93cab17b9" kindref="member">rHitLayerEnemy</ref><sp/>=<sp/>1<sp/>&lt;&lt;<sp/>LayerMask.NameToLayer(</highlight><highlight class="stringliteral">&quot;ALLY&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="446" refid="class_unit_1aa9e5811f476bcdfc35f060df91d1a110" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aa9e5811f476bcdfc35f060df91d1a110" kindref="member">Squad_OnInitiateUnitPositions</ref>()</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ThisTransform.position<sp/>=<sp/>TargetMovePositionObject.transform.position;</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ThisTransform.rotation<sp/>=<sp/>squad.PositionsTransform.rotation;</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="455" refid="class_unit_1aecd40137cf8799ee1a30a2b379615c04" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aecd40137cf8799ee1a30a2b379615c04" kindref="member">Squad_OnDrawUnitHpChanged</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>newValue)</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selection.SetActive(newValue);</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a05fc936d5804f3cedb391dc79a4f256f" kindref="member">OnHealthChanged</ref>(newValue);</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight></codeline>
<codeline lineno="461" refid="class_unit_1a05fc936d5804f3cedb391dc79a4f256f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a05fc936d5804f3cedb391dc79a4f256f" kindref="member">OnHealthChanged</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>drawHp)</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Color<sp/>color<sp/>=<sp/>Color.white;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(drawHp)</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>color<sp/>=<sp/><ref refid="class_unit_1a205111a0b5425bb82ddec5b16560d849" kindref="member">GetColorByHealth</ref>();</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selectionRenderer.color<sp/>=<sp/>color;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469" refid="class_unit_1a205111a0b5425bb82ddec5b16560d849" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>Color<sp/><ref refid="class_unit_1a205111a0b5425bb82ddec5b16560d849" kindref="member">GetColorByHealth</ref>()</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Color<sp/>color<sp/>=<sp/>Color.white;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>t<sp/>=<sp/><ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref><sp/>/<sp/>squad.UnitStats.Health;</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(t<sp/>&gt;=<sp/>0.5f)</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>color<sp/>=<sp/>Color.Lerp(Color.yellow,<sp/>Color.green,<sp/>t<sp/>*<sp/>2<sp/>-<sp/>1<sp/>-<sp/>0.3f);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>color<sp/>=<sp/>Color.Lerp(Color.red,<sp/>Color.yellow,<sp/>t<sp/>*<sp/>2<sp/>-<sp/>0.3f);</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>color;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483" refid="class_unit_1abe4d586d17e040670ba9416a1417c0ca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">internal</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1abe4d586d17e040670ba9416a1417c0ca" kindref="member">SetSelectionColor</ref>(Color<sp/>color)</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selection.GetComponent&lt;SpriteRenderer&gt;().color<sp/>=<sp/>color;</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="487"><highlight class="normal"></highlight></codeline>
<codeline lineno="488" refid="class_unit_1aa1a39b5e6d44e1b7a3ff80c484d2729d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aa1a39b5e6d44e1b7a3ff80c484d2729d" kindref="member">SetEquipment</ref>()</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a0a2b4ee4c7f6a9f602d9c67adc244ff4" kindref="member">SetHelmet</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1a9fd46393a3045d9798b8cc8b9bc78d05" kindref="member">Helmet</ref>);</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a56ddc994513940e041ed23df85e376cf" kindref="member">SetBody</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1aa1cf6e7ace4e2897220ff4f8896fca53" kindref="member">Body</ref>);</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aaac6e00f66c4165d5c152d9e8f88fc03" kindref="member">SetShield</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1a4280a990d639f958ff4c0e7249697a1f" kindref="member">Shield</ref>);</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ac1b02baf91d8c2b7d784e469f04c71a5" kindref="member">SetWeapon</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1aada92657ba049bb0a3856e157b4e0e22" kindref="member">Weapon</ref>);</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496" refid="class_unit_1ac1b02baf91d8c2b7d784e469f04c71a5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ac1b02baf91d8c2b7d784e469f04c71a5" kindref="member">SetWeapon</ref>(<ref refid="class_equipment" kindref="compound">Equipment</ref><sp/><ref refid="class_unit_1a75f07f8acd9d08df317a88440297035e" kindref="member">weapon</ref>)</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Destroy(<ref refid="class_unit_1a1c1d598622fce50f66ba18df1c968783" kindref="member">Weapon</ref>);</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a1c1d598622fce50f66ba18df1c968783" kindref="member">Weapon</ref><sp/>=<sp/>Instantiate(Resources.Load&lt;GameObject&gt;(weapon.<ref refid="class_item_1ab5454b792ec8183e499e187313654aa5" kindref="member">MainPropertie</ref>.<ref refid="struct_item_1_1_main_properties_1a74b146bc965410c0aefa0645b4fb9a6f" kindref="member">PathToPrefab</ref>),<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>);</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Weapon.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Weapon&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.weapon<sp/>=<sp/>(Weapon.transform.GetComponent&lt;<ref refid="class_item" kindref="compound">Item</ref>&gt;()<sp/>as<sp/><ref refid="class_equipment" kindref="compound">Equipment</ref>);</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.weapon.Stats<sp/>=<sp/>weapon.Stats;</highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!this.weapon.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a18798b5db90bb12a8c79ca987c028c3d" kindref="member">CanReformToPhalanx</ref>)</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1abad56474e40becd598f4edfd1d6addbc" kindref="member">SetArms</ref>(<ref refid="class_unit_1a2779427842436e81c3aaf60a656756a6" kindref="member">arms_with_sword</ref>);</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!this.weapon.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a3470ee48af6c71249a3436e052ecb22c" kindref="member">CanReformToPhalanxInFight</ref>)</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1abad56474e40becd598f4edfd1d6addbc" kindref="member">SetArms</ref>(<ref refid="class_unit_1acdc0f0874a0e00574a1c8997757534ab" kindref="member">arms_with_pike</ref>);</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1abad56474e40becd598f4edfd1d6addbc" kindref="member">SetArms</ref>(<ref refid="class_unit_1ad9874966b06e1c4eee55a335d2aa611e" kindref="member">arms_with_spear</ref>);</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518" refid="class_unit_1aaac6e00f66c4165d5c152d9e8f88fc03" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aaac6e00f66c4165d5c152d9e8f88fc03" kindref="member">SetShield</ref>(<ref refid="class_equipment" kindref="compound">Equipment</ref><sp/><ref refid="class_unit_1ab794b52831585c67e9e88c021ac7739c" kindref="member">shield</ref>)</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Destroy(<ref refid="class_unit_1ac5118086252debc28d4ce9b1676b003c" kindref="member">Shield</ref>);</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ac5118086252debc28d4ce9b1676b003c" kindref="member">Shield</ref><sp/>=<sp/>Instantiate(Resources.Load&lt;GameObject&gt;(shield.<ref refid="class_item_1ab5454b792ec8183e499e187313654aa5" kindref="member">MainPropertie</ref>.<ref refid="struct_item_1_1_main_properties_1a74b146bc965410c0aefa0645b4fb9a6f" kindref="member">PathToPrefab</ref>),<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>);</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Shield.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Shield&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.shield<sp/>=<sp/>(Shield.transform.GetComponent&lt;<ref refid="class_item" kindref="compound">Item</ref>&gt;()<sp/>as<sp/><ref refid="class_equipment" kindref="compound">Equipment</ref>);</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.shield.Stats<sp/>=<sp/>shield.Stats;</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="526"><highlight class="normal"></highlight></codeline>
<codeline lineno="527" refid="class_unit_1a56ddc994513940e041ed23df85e376cf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a56ddc994513940e041ed23df85e376cf" kindref="member">SetBody</ref>(<ref refid="class_equipment" kindref="compound">Equipment</ref><sp/><ref refid="class_unit_1ac5cd40c1443543628fd9739b96d81d96" kindref="member">body</ref>)</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Destroy(<ref refid="class_unit_1a8c29ddac1642c3fe9b293dfdbc7eaccf" kindref="member">Body</ref>);</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a8c29ddac1642c3fe9b293dfdbc7eaccf" kindref="member">Body</ref><sp/>=<sp/>Instantiate(Resources.Load&lt;GameObject&gt;(body.<ref refid="class_item_1ab5454b792ec8183e499e187313654aa5" kindref="member">MainPropertie</ref>.<ref refid="struct_item_1_1_main_properties_1a74b146bc965410c0aefa0645b4fb9a6f" kindref="member">PathToPrefab</ref>),<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>);</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Body.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Body&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.body<sp/>=<sp/>(Body.transform.GetComponent&lt;<ref refid="class_item" kindref="compound">Item</ref>&gt;()<sp/>as<sp/><ref refid="class_equipment" kindref="compound">Equipment</ref>);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.body.Stats<sp/>=<sp/>body.Stats;</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="535"><highlight class="normal"></highlight></codeline>
<codeline lineno="536" refid="class_unit_1a0a2b4ee4c7f6a9f602d9c67adc244ff4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a0a2b4ee4c7f6a9f602d9c67adc244ff4" kindref="member">SetHelmet</ref>(<ref refid="class_equipment" kindref="compound">Equipment</ref><sp/><ref refid="class_unit_1a9d599d97ac49cb583b6f0d1763c5cecf" kindref="member">helmet</ref>)</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Destroy(<ref refid="class_unit_1aed3b83c80208b0da9bc42633e01f3801" kindref="member">Helmet</ref>);</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aed3b83c80208b0da9bc42633e01f3801" kindref="member">Helmet</ref><sp/>=<sp/>Instantiate(Resources.Load&lt;GameObject&gt;(helmet.<ref refid="class_item_1ab5454b792ec8183e499e187313654aa5" kindref="member">MainPropertie</ref>.<ref refid="struct_item_1_1_main_properties_1a74b146bc965410c0aefa0645b4fb9a6f" kindref="member">PathToPrefab</ref>),<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>);</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Helmet.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Helmet&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.helmet<sp/>=<sp/>(Helmet.transform.GetComponent&lt;<ref refid="class_item" kindref="compound">Item</ref>&gt;()<sp/>as<sp/><ref refid="class_equipment" kindref="compound">Equipment</ref>);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>this.helmet.Stats<sp/>=<sp/>helmet.Stats;</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="544"><highlight class="normal"></highlight></codeline>
<codeline lineno="545" refid="class_unit_1abad56474e40becd598f4edfd1d6addbc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1abad56474e40becd598f4edfd1d6addbc" kindref="member">SetArms</ref>(GameObject<sp/><ref refid="class_unit_1aac1f5a22622125673575c668cc4a456a" kindref="member">arms</ref>)</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Destroy(<ref refid="class_unit_1a763073471f02015e11f355ed655dc571" kindref="member">Arms</ref>);</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a763073471f02015e11f355ed655dc571" kindref="member">Arms</ref><sp/>=<sp/>Instantiate(arms,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>);</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Arms.name<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Arms&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight></codeline>
<codeline lineno="552" refid="class_unit_1a3e1f7a137a4b8c36c9cd775536f29685" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a3e1f7a137a4b8c36c9cd775536f29685" kindref="member">SetProperties</ref>()</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="struct_equipment_stats" kindref="compound">EquipmentStats</ref>[]<sp/>equipStats<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="struct_equipment_stats" kindref="compound">EquipmentStats</ref>[]</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.Inventory.Helmet.Stats,</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.Inventory.Body.Stats,</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.Inventory.Shield.Stats,</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.Inventory.Weapon.Stats</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="561"><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>health<sp/>=<sp/>stats.Health;</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref><sp/>=<sp/>UnitStats.CalcStats(squad.UnitStats,<sp/>equipStats,<sp/>squad.CurrentFormationModifyers);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(health<sp/>&gt;<sp/>0)</highlight><highlight class="comment">//без<sp/>проверки<sp/>юниты<sp/>умирают<sp/>при<sp/>инициализации</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stats.Health<sp/>=<sp/>health;</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rigidbody2D.mass<sp/>=<sp/>stats.Mass;</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="568"><highlight class="normal"></highlight></codeline>
<codeline lineno="569" refid="class_unit_1a174a13cc7070a9f77045c96a0aedcdba" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>RaycastHit2D<sp/><ref refid="class_unit_1a174a13cc7070a9f77045c96a0aedcdba" kindref="member">Cast</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>layers)</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a23be3a8485a5edfb36d928214531d070" kindref="member">SetDistanceLineForAttack</ref>();</highlight></codeline>
<codeline lineno="572"><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//rHit<sp/>=<sp/>Physics2D.Linecast(startRay.position,<sp/>endRay.position,<sp/>rHitLayer);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Physics2D.BoxCast(</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>startRay.position<sp/>+<sp/>(endRay.position<sp/>-<sp/>startRay.position)<sp/>/<sp/>2,</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Vector2(<ref refid="class_unit_1a17a709112cadd05f397d9f0de0bc8cbe" kindref="member">attackLineWidth</ref>,<sp/><ref refid="class_unit_1a2fb4a37c1323b2f767974c275137e96a" kindref="member">attackLineLength</ref>),</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Quaternion.LookRotation(endRay.position<sp/>-<sp/>startRay.position).eulerAngles.z,</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ad6bf077ca76b0d31861c3ef0229bc1d7" kindref="member">endRay</ref>.position<sp/>-<sp/><ref refid="class_unit_1a90ba6a64ce6b06b19746be8c24694007" kindref="member">startRay</ref>.position,</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layers</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585" refid="class_unit_1a23be3a8485a5edfb36d928214531d070" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a23be3a8485a5edfb36d928214531d070" kindref="member">SetDistanceLineForAttack</ref>()</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endRay.localPosition<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Vector3(<ref refid="class_unit_1ad6bf077ca76b0d31861c3ef0229bc1d7" kindref="member">endRay</ref>.localPosition.x,<sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1a10a59fae5a22c67e0b9c0ab3fe3ffc41" kindref="member">AttackDistance</ref>,<sp/><ref refid="class_unit_1ad6bf077ca76b0d31861c3ef0229bc1d7" kindref="member">endRay</ref>.localPosition.z);</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>startRay.localPosition<sp/>=<sp/>Vector3.MoveTowards(endRay.localPosition,<sp/>Vector3.zero,<sp/><ref refid="class_unit_1a2fb4a37c1323b2f767974c275137e96a" kindref="member">attackLineLength</ref>);</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>startRay.localPosition<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Vector3(<ref refid="class_unit_1a90ba6a64ce6b06b19746be8c24694007" kindref="member">startRay</ref>.localPosition.x,<sp/><ref refid="class_unit_1a90ba6a64ce6b06b19746be8c24694007" kindref="member">startRay</ref>.localPosition.y,<sp/><ref refid="class_unit_1ad6bf077ca76b0d31861c3ef0229bc1d7" kindref="member">endRay</ref>.localPosition.z);</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight></codeline>
<codeline lineno="592" refid="class_unit_1ae3d1ff4be646b4227fcfb6125822e313" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae3d1ff4be646b4227fcfb6125822e313" kindref="member">timerForCheckEquipment</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="593"><highlight class="normal"></highlight></codeline>
<codeline lineno="594" refid="class_unit_1a99a69e981cce14a41538066318308b08" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a99a69e981cce14a41538066318308b08" kindref="member">Update</ref>()</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>deltaTime<sp/>=<sp/>Time.deltaTime;</highlight></codeline>
<codeline lineno="597"><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>shadow.rotation<sp/>=<sp/>Quaternion.identity;</highlight></codeline>
<codeline lineno="599"><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ae3d1ff4be646b4227fcfb6125822e313" kindref="member">timerForCheckEquipment</ref><sp/>&lt;<sp/>0.5f)</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae3d1ff4be646b4227fcfb6125822e313" kindref="member">timerForCheckEquipment</ref><sp/>+=<sp/>deltaTime;</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a95a18047de7c98c3a6256788b178880d" kindref="member">CheckEquipment</ref>();</highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.SumPositionUnit(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="609"><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a93cdc599aa3a1f72faccfc235b2931d7" kindref="member">olreadyNotPushingAlly</ref><sp/>&amp;&amp;<sp/><ref refid="class_unit_1a46fef034c97d6f9f17679d02bc1c9690" kindref="member">pushedUnit</ref>.Count<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a61fb8d0ee5274d873330f1ccf161e4ab" kindref="member">timerPushingAlly</ref><sp/>&lt;<sp/><ref refid="class_unit_1a1daaf9112d09b011eba7489f681c0bde" kindref="member">delayAfterPushingAlly</ref>)</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a61fb8d0ee5274d873330f1ccf161e4ab" kindref="member">timerPushingAlly</ref><sp/>+=<sp/>deltaTime;</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a61fb8d0ee5274d873330f1ccf161e4ab" kindref="member">timerPushingAlly</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" kindref="member">pushingAlly</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a93cdc599aa3a1f72faccfc235b2931d7" kindref="member">olreadyNotPushingAlly</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="626"><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a4c74f2a22e862f3d5cf86c642a12a095" kindref="member">delayToFindTargetAndAttack</ref><sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" kindref="member">stanned</ref><sp/>&amp;&amp;<sp/>!<ref refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" kindref="member">pushingAlly</ref>)</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1abeace1ab14346ab2514c45d3a36f6878" kindref="member">timerForAttack</ref><sp/>&lt;<sp/><ref refid="class_unit_1ab3ca7ac097c387092dae0a7e9678401f" kindref="member">currentAttackDeltaTime</ref>)</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1abeace1ab14346ab2514c45d3a36f6878" kindref="member">timerForAttack</ref><sp/>+=<sp/>deltaTime;</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="class_unit_1a59672cb37571acc783f8cb950fa9b501" kindref="member">Hit</ref>)<sp/><ref refid="class_unit_1a59672cb37571acc783f8cb950fa9b501" kindref="member">Hit</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae0efff36974261941706357641ec0df9" kindref="member">AttackTarget</ref>();</highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a6260feff14d941446a49739bb497710e" kindref="member">timerForFindTarget</ref><sp/>&lt;<sp/><ref refid="class_unit_1ab104d1bd779a6d80939b314504f84680" kindref="member">findTargetDeltaTime</ref>)</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a6260feff14d941446a49739bb497710e" kindref="member">timerForFindTarget</ref><sp/>+=<sp/>deltaTime;</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a5249bde8d5dfe29dfdfe6e93caa4d005" kindref="member">FindTarget</ref>();</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="644"><highlight class="normal"></highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ae104b10a3d6d2fede6b2640ebbf26002" kindref="member">timerForUnion</ref><sp/>&lt;<sp/><ref refid="class_unit_1aecfa6ef8287ba34e580703fabf6f4961" kindref="member">unionCheckDeltatime</ref>)</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae104b10a3d6d2fede6b2640ebbf26002" kindref="member">timerForUnion</ref><sp/>+=<sp/>deltaTime;</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae4d010414df5ec67d5586d0c79279f5d" kindref="member">CheckToUnion</ref>();</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4c74f2a22e862f3d5cf86c642a12a095" kindref="member">delayToFindTargetAndAttack</ref><sp/>-=<sp/>deltaTime;</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight></codeline>
<codeline lineno="656" refid="class_unit_1ae4d010414df5ec67d5586d0c79279f5d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae4d010414df5ec67d5586d0c79279f5d" kindref="member">CheckToUnion</ref>()</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae104b10a3d6d2fede6b2640ebbf26002" kindref="member">timerForUnion</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a8334983a56e9eff377bc3f0257308f65" kindref="member">selected</ref><sp/>&amp;&amp;<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>==<sp/>null)</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1a781a32dd5c6fadbe0a9e04f142ddc9da" kindref="member">playerSquadInstance</ref>.<ref refid="class_squad_1a14f16d0bd1098a523c721fb610247c56" kindref="member">UnitCount</ref><sp/>&lt;<sp/><ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1a781a32dd5c6fadbe0a9e04f142ddc9da" kindref="member">playerSquadInstance</ref>.<ref refid="class_squad_1a0e83cf3d9cc58d693d73490ce0e04db4" kindref="member">FULL_SQUAD_UNIT_COUNT</ref>)</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dist<sp/>=<sp/>Vector2.Distance(ThisTransform.position,<sp/>Squad.playerSquadInstance.CenterSquad);</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dist<sp/>&lt;=<sp/><ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1a781a32dd5c6fadbe0a9e04f142ddc9da" kindref="member">playerSquadInstance</ref>.<ref refid="class_squad_1a5765e8f707742c3c62885caf0b761813" kindref="member">DistanceToUnionWithSquad</ref><sp/>&amp;&amp;<sp/>!<ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1a781a32dd5c6fadbe0a9e04f142ddc9da" kindref="member">playerSquadInstance</ref>.<ref refid="class_squad_1a17079c457a2cd7ba2d4fd936d8c9d17e" kindref="member">InFight</ref>)</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Squad.playerSquadInstance.AddUnit(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight></codeline>
<codeline lineno="670" refid="class_unit_1a5249bde8d5dfe29dfdfe6e93caa4d005" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a5249bde8d5dfe29dfdfe6e93caa4d005" kindref="member">FindTarget</ref>()</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a6260feff14d941446a49739bb497710e" kindref="member">timerForFindTarget</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a44760b3254e2485581a6795c01b92688" kindref="member">rHit</ref><sp/>=<sp/><ref refid="class_unit_1a174a13cc7070a9f77045c96a0aedcdba" kindref="member">Cast</ref>(<ref refid="class_unit_1a9c15dea36c4d86be4bc211d93cab17b9" kindref="member">rHitLayerEnemy</ref>);</highlight></codeline>
<codeline lineno="677"><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref>)</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FormationStats.Formations.PHALANX:</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a44760b3254e2485581a6795c01b92688" kindref="member">rHit</ref>)</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1afc26b9fdc431362ef88ef9a2f17d69c9" kindref="member">SetTarget</ref>(<ref refid="class_unit_1a44760b3254e2485581a6795c01b92688" kindref="member">rHit</ref>.transform.gameObject.GetComponent&lt;<ref refid="class_unit" kindref="compound">Unit</ref>&gt;());</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1afc26b9fdc431362ef88ef9a2f17d69c9" kindref="member">SetTarget</ref>(null);</highlight></codeline>
<codeline lineno="685"><highlight class="normal"></highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="687"><highlight class="normal"></highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="comment">//<sp/>Formation.Formations.RANKS:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>==<sp/>null)</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a44760b3254e2485581a6795c01b92688" kindref="member">rHit</ref>)</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit" kindref="compound">Unit</ref><sp/>unit<sp/>=<sp/>rHit.transform.gameObject.GetComponent&lt;<ref refid="class_unit" kindref="compound">Unit</ref>&gt;();</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(unit.<ref refid="class_unit_1a8334983a56e9eff377bc3f0257308f65" kindref="member">selected</ref>)</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1afc26b9fdc431362ef88ef9a2f17d69c9" kindref="member">SetTarget</ref>(unit);</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dist<sp/>=<sp/>Vector2.Distance(target.ThisTransform.position,<sp/>ThisTransform.position);</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dist<sp/>&gt;<sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1a10a59fae5a22c67e0b9c0ab3fe3ffc41" kindref="member">AttackDistance</ref><sp/>||<sp/>!<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref>.<ref refid="class_unit_1a4aa7e5de646cca24872f72e9aa0752ed" kindref="member">Selected</ref>)</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1afc26b9fdc431362ef88ef9a2f17d69c9" kindref="member">SetTarget</ref>(null);</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="704"><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710" refid="class_unit_1ae0efff36974261941706357641ec0df9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae0efff36974261941706357641ec0df9" kindref="member">AttackTarget</ref>()</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1abeace1ab14346ab2514c45d3a36f6878" kindref="member">timerForAttack</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target.TakeHitFromUnit(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a8b3a01aa9bcb80d06776dbc44f7e0048" kindref="member">SetAttakingFlag</ref>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a59672cb37571acc783f8cb950fa9b501" kindref="member">Hit</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a8b3a01aa9bcb80d06776dbc44f7e0048" kindref="member">SetAttakingFlag</ref>(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight></codeline>
<codeline lineno="725" refid="class_unit_1a8b3a01aa9bcb80d06776dbc44f7e0048" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a8b3a01aa9bcb80d06776dbc44f7e0048" kindref="member">SetAttakingFlag</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>flag)</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(flag<sp/>&amp;&amp;<sp/>!<ref refid="class_unit_1a5f06967732cecb0a195a9e0085f752a6" kindref="member">attaking</ref>)</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.AttakingUnitsCount++;</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!flag<sp/>&amp;&amp;<sp/><ref refid="class_unit_1a5f06967732cecb0a195a9e0085f752a6" kindref="member">attaking</ref>)</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.AttakingUnitsCount--;</highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a5f06967732cecb0a195a9e0085f752a6" kindref="member">attaking</ref><sp/>=<sp/>flag;</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="734"><highlight class="normal"></highlight></codeline>
<codeline lineno="735" refid="class_unit_1a91f7fe68f3b4ed2ec8b5f5418aaef5f0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a91f7fe68f3b4ed2ec8b5f5418aaef5f0" kindref="member">OnReformSquad</ref>(<ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref><sp/>newFormation)</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(newFormation)</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FormationStats.Formations.RANKS:</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a158678cf2f1e886556be5a09d410d355" kindref="member">OnReformInRanks</ref>();</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FormationStats.Formations.PHALANX:</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a3aa682580b85a10b6fd92be762fb8439" kindref="member">OnReformInPhalanx</ref>();</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FormationStats.Formations.RISEDSHIELDS:</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="749"><highlight class="normal"></highlight></codeline>
<codeline lineno="750" refid="class_unit_1a158678cf2f1e886556be5a09d410d355" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a158678cf2f1e886556be5a09d410d355" kindref="member">OnReformInRanks</ref>()</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1adbbc18d9fb756fbb4be7e449196b876c" kindref="member">RotateBody</ref>(0);</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="754"><highlight class="normal"></highlight></codeline>
<codeline lineno="755" refid="class_unit_1a3aa682580b85a10b6fd92be762fb8439" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a3aa682580b85a10b6fd92be762fb8439" kindref="member">OnReformInPhalanx</ref>()</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>f<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ae64583504b6d818650d5b48ab1b26614" kindref="member">TargetMovePositionObject</ref>.<ref refid="class_unit_position_1a2fc4721874458770dec4f2e29c71904a" kindref="member">RowInPhalanx</ref><sp/>%<sp/>2<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ae64583504b6d818650d5b48ab1b26614" kindref="member">TargetMovePositionObject</ref>.<ref refid="class_unit_position_1a2fc4721874458770dec4f2e29c71904a" kindref="member">RowInPhalanx</ref><sp/>%<sp/>3<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1adbbc18d9fb756fbb4be7e449196b876c" kindref="member">RotateBody</ref>(f<sp/>*<sp/><ref refid="class_unit_1a6a103535cb0664025d482523d10a5b5b" kindref="member">weaponAngleDeviation</ref>);</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="765"><highlight class="normal"></highlight></codeline>
<codeline lineno="766" refid="class_unit_1adbbc18d9fb756fbb4be7e449196b876c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1adbbc18d9fb756fbb4be7e449196b876c" kindref="member">RotateBody</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>angle)</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/><ref refid="class_unit_1a75f07f8acd9d08df317a88440297035e" kindref="member">weapon</ref><sp/>=<sp/>Weapon.transform;</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>hands<sp/>=<sp/>arms.transform;</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/><ref refid="class_unit_1ac5cd40c1443543628fd9739b96d81d96" kindref="member">body</ref><sp/>=<sp/>Body.transform;</highlight></codeline>
<codeline lineno="771"><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>weapon.localRotation<sp/>=<sp/>Quaternion.identity<sp/>*<sp/>Quaternion.Euler(0,<sp/>0,<sp/>angle);</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hands.localRotation<sp/>=<sp/>Quaternion.identity<sp/>*<sp/>Quaternion.Euler(0,<sp/>0,<sp/>angle);</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>body.localRotation<sp/>=<sp/>Quaternion.identity<sp/>*<sp/>Quaternion.Euler(0,<sp/>0,<sp/>angle);</highlight></codeline>
<codeline lineno="775"><highlight class="normal"></highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>sin<sp/>=<sp/>Mathf.Sin(-angle<sp/>*<sp/>Mathf.Deg2Rad);</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>cos<sp/>=<sp/>Mathf.Cos(-angle<sp/>*<sp/>Mathf.Deg2Rad);</highlight></codeline>
<codeline lineno="778"><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Vector2<sp/>p<sp/>=<sp/>endRay.localPosition;</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endRay.localPosition<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Vector3(</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p.magnitude<sp/>*<sp/>sin,</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p.magnitude<sp/>*<sp/>cos,</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ad6bf077ca76b0d31861c3ef0229bc1d7" kindref="member">endRay</ref>.localPosition.z</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="786"><highlight class="normal"></highlight></codeline>
<codeline lineno="787" refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a16901fd541a019ec9d03c4d87f605090" kindref="member">OnDropStack</ref>(<ref refid="class_equipment_stack" kindref="compound">EquipmentStack</ref><sp/>stack)</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stack.<ref refid="class_equipment_stack_1aea353e00a5c0c6e964fcfe01db42d12b" kindref="member">Count</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack.PopItems(1);</highlight></codeline>
<codeline lineno="792"><highlight class="normal"></highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_dropped_item" kindref="compound">DroppedItem</ref><sp/>di<sp/>=<sp/>Instantiate(<ref refid="class_unit_1a24c4e2364b3728bad6c9c8d59eed1d67" kindref="member">DroppedItemOriginal</ref>,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,<sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation,<sp/><ref refid="class_unit_1a934c70f47e775cc45f8deaed4166edf6" kindref="member">DroppedItemsContainer</ref>).GetComponent&lt;<ref refid="class_dropped_item" kindref="compound">DroppedItem</ref>&gt;();</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>di.Stack<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_equipment_stack" kindref="compound">EquipmentStack</ref>(stack.<ref refid="class_equipment_stack_1a7c41008f3dc56ac19774468efd798d48" kindref="member">EquipmentMainProperties</ref>,<sp/>stack.<ref refid="class_equipment_stack_1afd0cfe57cae1b79a1e63aa64caaebe9e" kindref="member">EquipmentStats</ref>);</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="797"><highlight class="normal"></highlight></codeline>
<codeline lineno="798" refid="class_unit_1a95a18047de7c98c3a6256788b178880d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a95a18047de7c98c3a6256788b178880d" kindref="member">CheckEquipment</ref>()</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae3d1ff4be646b4227fcfb6125822e313" kindref="member">timerForCheckEquipment</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>equipChanged<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a9d599d97ac49cb583b6f0d1763c5cecf" kindref="member">helmet</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a40d92422bb84c73f61b6f3102da17dfb" kindref="member">Id</ref><sp/>!=<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1a9fd46393a3045d9798b8cc8b9bc78d05" kindref="member">Helmet</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a40d92422bb84c73f61b6f3102da17dfb" kindref="member">Id</ref>)</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a0a2b4ee4c7f6a9f602d9c67adc244ff4" kindref="member">SetHelmet</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1a9fd46393a3045d9798b8cc8b9bc78d05" kindref="member">Helmet</ref>);</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>equipChanged<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ac5cd40c1443543628fd9739b96d81d96" kindref="member">body</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a40d92422bb84c73f61b6f3102da17dfb" kindref="member">Id</ref><sp/>!=<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1aa1cf6e7ace4e2897220ff4f8896fca53" kindref="member">Body</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a40d92422bb84c73f61b6f3102da17dfb" kindref="member">Id</ref>)</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a56ddc994513940e041ed23df85e376cf" kindref="member">SetBody</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1aa1cf6e7ace4e2897220ff4f8896fca53" kindref="member">Body</ref>);</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>equipChanged<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab794b52831585c67e9e88c021ac7739c" kindref="member">shield</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a40d92422bb84c73f61b6f3102da17dfb" kindref="member">Id</ref><sp/>!=<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1a4280a990d639f958ff4c0e7249697a1f" kindref="member">Shield</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a40d92422bb84c73f61b6f3102da17dfb" kindref="member">Id</ref>)</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aaac6e00f66c4165d5c152d9e8f88fc03" kindref="member">SetShield</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1a4280a990d639f958ff4c0e7249697a1f" kindref="member">Shield</ref>);</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>equipChanged<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a75f07f8acd9d08df317a88440297035e" kindref="member">weapon</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a40d92422bb84c73f61b6f3102da17dfb" kindref="member">Id</ref><sp/>!=<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1aada92657ba049bb0a3856e157b4e0e22" kindref="member">Weapon</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1a40d92422bb84c73f61b6f3102da17dfb" kindref="member">Id</ref>)</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ac1b02baf91d8c2b7d784e469f04c71a5" kindref="member">SetWeapon</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1aada92657ba049bb0a3856e157b4e0e22" kindref="member">Weapon</ref>);</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>equipChanged<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(equipChanged)</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a3e1f7a137a4b8c36c9cd775536f29685" kindref="member">SetProperties</ref>();</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="826"><highlight class="normal"></highlight></codeline>
<codeline lineno="827" refid="class_unit_1ac54c63324f75df592ac77af1ed3eaefe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ac54c63324f75df592ac77af1ed3eaefe" kindref="member">OnFormationChanged</ref>(<ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref><sp/>newFormation)</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a3e1f7a137a4b8c36c9cd775536f29685" kindref="member">SetProperties</ref>();</highlight></codeline>
<codeline lineno="830"><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>==<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.PHALANX)</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab3ca7ac097c387092dae0a7e9678401f" kindref="member">currentAttackDeltaTime</ref><sp/>=<sp/><ref refid="class_unit_1a65bedc95f047dd664f0930360e987d4a" kindref="member">attacInPhalanxDeltaTime</ref>;</highlight></codeline>
<codeline lineno="834"><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" kindref="member">pushingAlly</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushedUnit.Clear();</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>==<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.RANKS)</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab3ca7ac097c387092dae0a7e9678401f" kindref="member">currentAttackDeltaTime</ref><sp/>=<sp/><ref refid="class_unit_1a6c2a41380ef9b7baf0470d915fad494f" kindref="member">attacInRanksDeltaTime</ref>;</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="843"><highlight class="normal"></highlight></codeline>
<codeline lineno="844" refid="class_unit_1a2046212facf95c83ea45911592f98f06" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a2046212facf95c83ea45911592f98f06" kindref="member">FixedUpdate</ref>()</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a1e9e529012bcd3c9538eda06da32840b" kindref="member">Moving</ref>();</highlight></codeline>
<codeline lineno="848"><highlight class="normal"></highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>&amp;&amp;<sp/>!<ref refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" kindref="member">pushingAlly</ref><sp/>&amp;&amp;<sp/>!<ref refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" kindref="member">stanned</ref>)</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref><sp/>&lt;<sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1a3ae741eba64620c23193afb733961547" kindref="member">Speed</ref>)</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref><sp/>+=<sp/>stats.Acceleretion<sp/>*<sp/>Time.deltaTime;</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref><sp/>=<sp/>stats.Speed;</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="861"><highlight class="normal"></highlight></codeline>
<codeline lineno="862" refid="class_unit_1a6122214b77883efe36237c9f25aaab5b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a6122214b77883efe36237c9f25aaab5b" kindref="member">TakeHitFromUnit</ref>(<ref refid="class_unit" kindref="compound">Unit</ref><sp/>enemy)</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Quaternion<sp/>enemyRot<sp/>=<sp/>Quaternion.LookRotation(Vector3.forward,<sp/>enemy.ThisTransform.position<sp/>-<sp/>ThisTransform.position);</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>rot<sp/>=<sp/>enemyRot.eulerAngles.z<sp/>-<sp/>ThisTransform.rotation.eulerAngles.z;</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rot<sp/>=<sp/>rot<sp/>&lt;<sp/>0<sp/>?<sp/>-rot<sp/>:<sp/>rot;</highlight></codeline>
<codeline lineno="867"><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>it<sp/>attack<sp/>from<sp/>back</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rot<sp/>&gt;<sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1a80ff4cc801aa72f11a0710f54bffeb12" kindref="member">DefenceHalfSector</ref><sp/>&amp;&amp;<sp/>rot<sp/>&lt;<sp/>360<sp/>-<sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1a80ff4cc801aa72f11a0710f54bffeb12" kindref="member">DefenceHalfSector</ref>)</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae61f57dcc4db8900d0aed2a2818480f5" kindref="member">takeHit</ref><sp/>=<sp/>enemy.stats.Attack;</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>==<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.PHALANX<sp/>||<sp/><ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae61f57dcc4db8900d0aed2a2818480f5" kindref="member">takeHit</ref><sp/>=<sp/>enemy.stats.Attack<sp/>*<sp/>(1<sp/>-<sp/>stats.Defence);</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//если<sp/>нет<sp/>цели<sp/>и<sp/>не<sp/>фаланга<sp/>(т.е.<sp/>отряд<sp/>пытается<sp/>пробежать<sp/>насквозь<sp/>другой<sp/>отряд)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//то<sp/>не<sp/>защищаться</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ae61f57dcc4db8900d0aed2a2818480f5" kindref="member">takeHit</ref><sp/>=<sp/>enemy.stats.Attack<sp/>*<sp/>(1<sp/>-<sp/>stats.Defence<sp/>*<sp/>stats.DefenceGoingThrought);</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="882"><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>==<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.RANKS<sp/>&amp;&amp;<sp/><ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>==<sp/>null)</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(enemy.<ref refid="class_unit_1a4aa7e5de646cca24872f72e9aa0752ed" kindref="member">Selected</ref><sp/>&amp;&amp;<sp/>Vector2.Distance(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,<sp/>enemy.<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position)<sp/>&lt;=<sp/>stats.AttackDistance)</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1afc26b9fdc431362ef88ef9a2f17d69c9" kindref="member">SetTarget</ref>(enemy);</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="888"><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dmg<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//если<sp/>враг<sp/>попал<sp/>по<sp/>нам</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(UnityEngine.Random.value<sp/>&lt;=<sp/><ref refid="class_unit_1ae61f57dcc4db8900d0aed2a2818480f5" kindref="member">takeHit</ref>)</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>=<sp/>enemy.stats.Damage.BaseDamage<sp/>+<sp/>enemy.stats.Damage.ArmourDamage<sp/>-<sp/>stats.Armour;</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dmg<sp/>&lt;<sp/>enemy.<ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1a92c336291a7a1dec8f1291fdca796bdc" kindref="member">Damage</ref>.<ref refid="struct_damage_1a540de67f1528f23cc0c61d1bcc3f6143" kindref="member">ArmourDamage</ref>)</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>=<sp/>enemy.stats.Damage.ArmourDamage;</highlight></codeline>
<codeline lineno="896"><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4d5cde8815a3a4755e2d30b23bd52b36" kindref="member">TakeDamage</ref>(dmg,<sp/>enemy.<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>,<sp/>enemy);</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="900"><highlight class="normal"></highlight></codeline>
<codeline lineno="901" refid="class_unit_1a81ef87020279968371316b61ae6b408c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a81ef87020279968371316b61ae6b408c" kindref="member">TakeHitFromArrow</ref>(<ref refid="struct_damage" kindref="compound">Damage</ref><sp/>damage,<sp/><ref refid="class_arrows_valley" kindref="compound">ArrowsValley</ref><sp/>valley)</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dmg<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="904"><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Quaternion<sp/>enemyRot<sp/>=<sp/>Quaternion.LookRotation(Vector3.forward,<sp/>valley.transform.position<sp/>-<sp/>ThisTransform.position);</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>rot<sp/>=<sp/>enemyRot.eulerAngles.z<sp/>-<sp/>ThisTransform.rotation.eulerAngles.z;</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rot<sp/>=<sp/>rot<sp/>&lt;<sp/>0<sp/>?<sp/>-rot<sp/>:<sp/>rot;</highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>chanceTohit<sp/>=<sp/>1<sp/>-<sp/>stats.MissileBlock;</highlight></codeline>
<codeline lineno="910"><highlight class="normal"></highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//если<sp/>стрелы<sp/>летят<sp/>в<sp/>спину</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(rot<sp/>&lt;=<sp/>stats.DefenceHalfSector<sp/>||<sp/>rot<sp/>&gt;=<sp/>360<sp/>-<sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1a80ff4cc801aa72f11a0710f54bffeb12" kindref="member">DefenceHalfSector</ref>))</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//если<sp/>есть<sp/>щит,<sp/>то<sp/>увеличиваем<sp/>шанс<sp/>попадания<sp/>(так<sp/>как<sp/>мы<sp/>уже<sp/>учли<sp/>щит<sp/>в<sp/>статах)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null<sp/>&amp;&amp;<sp/>!<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a000c2e8cc307d9629751785b96b53ce5" kindref="member">Inventory</ref>.<ref refid="class_inventory_1a4280a990d639f958ff4c0e7249697a1f" kindref="member">Shield</ref>.<ref refid="class_equipment_1a41b8725e8599baea7fd05b0725fa4812" kindref="member">Stats</ref>.<ref refid="struct_equipment_stats_1abd05f10096c1d46af0f13806b754118e" kindref="member">Empty</ref>)</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>shieldMissileBlock<sp/>=<sp/>(squad.Inventory.Shield).<ref refid="class_unit_1a45c42ced508cd035199cbfd52ebf62f0" kindref="member">Stats</ref>.<ref refid="struct_unit_stats_1a4d4b420d724303bdc94c881ee801f729" kindref="member">MissileBlock</ref>;</highlight></codeline>
<codeline lineno="918"><highlight class="normal"></highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>!=<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.RISEDSHIELDS)</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>shieldMissileBlock<sp/>*=<sp/>0.5f;</highlight></codeline>
<codeline lineno="921"><highlight class="normal"></highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chanceTohit<sp/>+=<sp/>shieldMissileBlock;</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="925"><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(UnityEngine.Random.value<sp/>&lt;=<sp/>chanceTohit)</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>=<sp/>damage.BaseDamage<sp/>-<sp/>stats.Armour;</highlight></codeline>
<codeline lineno="929"><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//если<sp/>щиты<sp/>подняты,<sp/>то<sp/>учитываем<sp/>их<sp/>броню</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null<sp/>&amp;&amp;<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>==<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.RISEDSHIELDS)</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>-=<sp/>(squad.Inventory.Shield).<ref refid="class_unit_1a45c42ced508cd035199cbfd52ebf62f0" kindref="member">Stats</ref>.<ref refid="struct_unit_stats_1a17ccd0ee79d684de9a8b5f6fd211db43" kindref="member">Armour</ref>;</highlight></codeline>
<codeline lineno="933"><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(dmg<sp/>&lt;<sp/>damage.<ref refid="struct_damage_1a540de67f1528f23cc0c61d1bcc3f6143" kindref="member">ArmourDamage</ref>)</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>=<sp/>damage.ArmourDamage;</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4d5cde8815a3a4755e2d30b23bd52b36" kindref="member">TakeDamage</ref>(dmg,<sp/>valley.<ref refid="class_arrows_valley_1afd5dda6f06671410bc6c12ed1cdf4ac2" kindref="member">owner</ref>);</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>friendlyfire<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gameObject.layer<sp/>!=<sp/>LayerMask.NameToLayer(<ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1abe71578ac0516480f581c7011b1a3ea5" kindref="member">UnitFraction</ref>.ENEMY.ToString())<sp/>&amp;&amp;<sp/>valley.<ref refid="class_arrows_valley_1afd5dda6f06671410bc6c12ed1cdf4ac2" kindref="member">owner</ref><sp/>==<sp/><ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1a781a32dd5c6fadbe0a9e04f142ddc9da" kindref="member">playerSquadInstance</ref>)</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>friendlyfire<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a03d76f15a5d46dda8d06eeae656bbb76" kindref="member">ShowPopUpTakenDamageText</ref>(</highlight><highlight class="stringliteral">&quot;block&quot;</highlight><highlight class="normal">,<sp/>friendlyfire);</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="947"><highlight class="normal"></highlight></codeline>
<codeline lineno="953" refid="class_unit_1a745b729665521cee8b7288e52ecba6e3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a745b729665521cee8b7288e52ecba6e3" kindref="member">TakeHit</ref>(<ref refid="struct_damage" kindref="compound">Damage</ref><sp/>damage)</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dmg<sp/>=<sp/>damage.BaseDamage<sp/>-<sp/>stats.Armour;</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dmg<sp/>&lt;<sp/>damage.<ref refid="struct_damage_1a540de67f1528f23cc0c61d1bcc3f6143" kindref="member">ArmourDamage</ref>)</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>=<sp/>damage.ArmourDamage;</highlight></codeline>
<codeline lineno="959"><highlight class="normal"></highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4d5cde8815a3a4755e2d30b23bd52b36" kindref="member">TakeDamage</ref>(dmg,<sp/>null);</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="962"><highlight class="normal"></highlight></codeline>
<codeline lineno="963" refid="class_unit_1a4d5cde8815a3a4755e2d30b23bd52b36" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4d5cde8815a3a4755e2d30b23bd52b36" kindref="member">TakeDamage</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>damage,<sp/><ref refid="class_squad" kindref="compound">Squad</ref><sp/>owner,<sp/><ref refid="class_unit" kindref="compound">Unit</ref><sp/>enemy<sp/>=<sp/>null)</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref><sp/>-<sp/>damage<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>damage<sp/>=<sp/><ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref>;</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aa9485f087a4a27b827435b20a5325770" kindref="member">Health</ref><sp/>-=<sp/>damage;</highlight></codeline>
<codeline lineno="968"><highlight class="normal"></highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1adaa305f796b977b923b801a9d2f8e7ce" kindref="member">AfterTakingDamage</ref>(damage,<sp/>owner);</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="971"><highlight class="normal"></highlight></codeline>
<codeline lineno="972" refid="class_unit_1ab88c2b3e7f4a12624e3072c0e29fc843" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ab88c2b3e7f4a12624e3072c0e29fc843" kindref="member">Heal</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>health)</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(health<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stats.Health<sp/>+=<sp/>health;</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="977"><highlight class="normal"></highlight></codeline>
<codeline lineno="978" refid="class_unit_1a90279f0cd15d3d8432482503109430c8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a90279f0cd15d3d8432482503109430c8" kindref="member">AddTargettedBy</ref>(<ref refid="class_unit" kindref="compound">Unit</ref><sp/>unit)</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a95573f5c0d7610e5ef074df6c2684131" kindref="member">targettedBy</ref>.Count<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.TargettedUnitsCount++;</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>targettedBy.Add(unit);</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="984"><highlight class="normal"></highlight></codeline>
<codeline lineno="985" refid="class_unit_1aa57eef95b0e2c6d1b4a11edb7b08c450" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aa57eef95b0e2c6d1b4a11edb7b08c450" kindref="member">RemoveTagrettedBy</ref>(<ref refid="class_unit" kindref="compound">Unit</ref><sp/>unit)</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>targettedBy.Remove(unit);</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a95573f5c0d7610e5ef074df6c2684131" kindref="member">targettedBy</ref>.Count<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>squad.TargettedUnitsCount--;</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="991"><highlight class="normal"></highlight></codeline>
<codeline lineno="992" refid="class_unit_1afc26b9fdc431362ef88ef9a2f17d69c9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1afc26b9fdc431362ef88ef9a2f17d69c9" kindref="member">SetTarget</ref>(<ref refid="class_unit" kindref="compound">Unit</ref><sp/>newTarget)</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>==<sp/>null<sp/>&amp;&amp;<sp/>newTarget<sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newTarget.AddTargettedBy(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>!=<sp/>null<sp/>&amp;&amp;<sp/>newTarget<sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target.RemoveTagrettedBy(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newTarget.AddTargettedBy(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>!=<sp/>null<sp/>&amp;&amp;<sp/>newTarget<sp/>==<sp/>null)</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target.RemoveTagrettedBy(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>=<sp/>newTarget;</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"></highlight></codeline>
<codeline lineno="1016" refid="class_unit_1adaa305f796b977b923b801a9d2f8e7ce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1adaa305f796b977b923b801a9d2f8e7ce" kindref="member">AfterTakingDamage</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dmg,<sp/><ref refid="class_squad" kindref="compound">Squad</ref><sp/>owner)</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/><ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1a781a32dd5c6fadbe0a9e04f142ddc9da" kindref="member">playerSquadInstance</ref><sp/>&amp;&amp;<sp/>owner<sp/>==<sp/><ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1a781a32dd5c6fadbe0a9e04f142ddc9da" kindref="member">playerSquadInstance</ref>)</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GameManager.Instance.PlayerProgress.score.expirience.Value<sp/>+=<sp/>(int)dmg;</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"></highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>friendlyfire<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gameObject.layer<sp/>!=<sp/>LayerMask.NameToLayer(<ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1abe71578ac0516480f581c7011b1a3ea5" kindref="member">UnitFraction</ref>.ENEMY.ToString())<sp/>&amp;&amp;<sp/>owner<sp/>==<sp/><ref refid="class_squad" kindref="compound">Squad</ref>.<ref refid="class_squad_1a781a32dd5c6fadbe0a9e04f142ddc9da" kindref="member">playerSquadInstance</ref>)</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>friendlyfire<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a03d76f15a5d46dda8d06eeae656bbb76" kindref="member">ShowPopUpTakenDamageText</ref>(dmg.ToString(</highlight><highlight class="stringliteral">&quot;0.#&quot;</highlight><highlight class="normal">),<sp/>friendlyfire);</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>==<sp/>null<sp/>||<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>!=<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.PHALANX)</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a99340fb487dc77c1913ea1c268a71714" kindref="member">TakeStan</ref>();</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"></highlight></codeline>
<codeline lineno="1031" refid="class_unit_1a03d76f15a5d46dda8d06eeae656bbb76" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a03d76f15a5d46dda8d06eeae656bbb76" kindref="member">ShowPopUpTakenDamageText</ref>(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>text,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>friendly<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_game_manager" kindref="compound">GameManager</ref>.<ref refid="class_game_manager_1ad3e717f4fb0f378b969f4457de81f23e" kindref="member">Instance</ref>.<ref refid="class_game_manager_1ae648b8f0ba536cd87e04e9a5b3b217fd" kindref="member">Settings</ref>.<ref refid="class_settings_1aa2a99148bd27ecbd3cee7774b8e5e0e7" kindref="member">graphixSettings</ref>.<ref refid="class_graphix_settings_1afe7164c98cd36b3955b032239428d473" kindref="member">ShowDamage</ref>)</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Color<sp/>color;</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"></highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(friendly)</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>color<sp/>=<sp/>GameManager.Instance.Settings.graphixSettings.FrieldlyDamageColor;</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>color<sp/>=<sp/>GameManager.Instance.Settings.graphixSettings.DamageToAllyColor;</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(gameObject.layer<sp/>==<sp/>LayerMask.NameToLayer(</highlight><highlight class="stringliteral">&quot;ENEMY&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>color<sp/>=<sp/><ref refid="class_game_manager" kindref="compound">GameManager</ref>.<ref refid="class_game_manager_1ad3e717f4fb0f378b969f4457de81f23e" kindref="member">Instance</ref>.<ref refid="class_game_manager_1ae648b8f0ba536cd87e04e9a5b3b217fd" kindref="member">Settings</ref>.<ref refid="class_settings_1aa2a99148bd27ecbd3cee7774b8e5e0e7" kindref="member">graphixSettings</ref>.<ref refid="class_graphix_settings_1a838a12e25f9b258e41d0442894510d50" kindref="member">DamageToEnemyColor</ref>;</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"></highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Color<sp/>endColor<sp/>=<sp/>color;</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endColor.a<sp/>=<sp/>0.5f;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_pop_up_text_controller" kindref="compound">PopUpTextController</ref>.<ref refid="class_pop_up_text_controller_1acea68bc7c971abbeabb2e2ed5cef381c" kindref="member">Instance</ref>.<ref refid="class_pop_up_text_controller_1a1e4b45a5364c994c3db66a9f487253f0" kindref="member">AddTextLabel</ref>(</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text,</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2,</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Vector2(0,<sp/>2),</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>color,</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endColor</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"></highlight></codeline>
<codeline lineno="1059" refid="class_unit_1a99340fb487dc77c1913ea1c268a71714" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a99340fb487dc77c1913ea1c268a71714" kindref="member">TakeStan</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>a<sp/>=<sp/>1)</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(a<sp/>&gt;<sp/>1<sp/>||<sp/>a<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Exception(</highlight><highlight class="stringliteral">&quot;Коефициент<sp/>a<sp/>дожен<sp/>быть<sp/>в<sp/>отрезке<sp/>[0,<sp/>1].<sp/>Переданное<sp/>значение:<sp/>&quot;</highlight><highlight class="normal"><sp/>+<sp/>a);</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" kindref="member">Charging</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"></highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>StartCoroutine(<ref refid="class_unit_1a4f30a868951d23aab3cd01c8dbd6d0ff" kindref="member">Stan</ref>(<ref refid="class_unit_1a64c1b3b029850374cbfd9480a89a9dde" kindref="member">delayAfterTakingDamage</ref><sp/>*<sp/>a));</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"></highlight></codeline>
<codeline lineno="1075" refid="class_unit_1a4f30a868951d23aab3cd01c8dbd6d0ff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>IEnumerator<sp/><ref refid="class_unit_1a4f30a868951d23aab3cd01c8dbd6d0ff" kindref="member">Stan</ref>(</highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>delay)</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" kindref="member">stanned</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yield<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>WaitForSeconds(delay);</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" kindref="member">stanned</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"></highlight></codeline>
<codeline lineno="1081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gameObject.layer<sp/>=<sp/><ref refid="class_unit_1ad02ba5df8a551a6bbaff1151b3c029f5" kindref="member">normLayer</ref>;</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"></highlight></codeline>
<codeline lineno="1084" refid="class_unit_1a140aa838eee5afb1fab30a324d822e99" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a140aa838eee5afb1fab30a324d822e99" kindref="member">MovingToTarget</ref>()</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4566909ad75b23c6326ccfa8cf040058" kindref="member">LookTo</ref>(<ref refid="class_unit_1ac4e4b283b602538748281cd30747e16e" kindref="member">calcTargetRotations</ref>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref>.<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position));</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"></highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Vector2.Distance(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position,<sp/><ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref>.<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position)<sp/>&gt;<sp/>stats.AttackDistance)</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a5613f6d79c066d34ecc77aaf471cd898" kindref="member">GoTo</ref>(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.up.normalized<sp/>*<sp/><ref refid="class_unit_1a634cbff3ef8348517936a486a0796883" kindref="member">CurrentSpeed</ref><sp/>*<sp/>Time.fixedDeltaTime);</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"></highlight></codeline>
<codeline lineno="1099" refid="class_unit_1a1e9e529012bcd3c9538eda06da32840b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a1e9e529012bcd3c9538eda06da32840b" kindref="member">Moving</ref>()</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" kindref="member">stanned</ref><sp/>&amp;&amp;<sp/>!<ref refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" kindref="member">pushingAlly</ref>)<sp/></highlight><highlight class="comment">//<sp/>squad<sp/>!=<sp/>null</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref>)</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FormationStats.Formations.RANKS:</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a772f31035a32739ae20bcc424c627f48" kindref="member">MovingInRanks</ref>();</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FormationStats.Formations.PHALANX:</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a197231e948c8f7d19d677b23e29a8c6e" kindref="member">MovingInPhalanx</ref>();</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>FormationStats.Formations.RISEDSHIELDS:</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a299553fca40075047e2749262d759277" kindref="member">MovingInRiseshields</ref>();</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"></highlight></codeline>
<codeline lineno="1118" refid="class_unit_1a299553fca40075047e2749262d759277" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a299553fca40075047e2749262d759277" kindref="member">MovingInRiseshields</ref>()</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a772f31035a32739ae20bcc424c627f48" kindref="member">MovingInRanks</ref>();</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"></highlight></codeline>
<codeline lineno="1123" refid="class_unit_1a197231e948c8f7d19d677b23e29a8c6e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a197231e948c8f7d19d677b23e29a8c6e" kindref="member">MovingInPhalanx</ref>()</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//отталкиваем<sp/>врага</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target.rigidbody2D.velocity<sp/>=<sp/>Vector2.zero;</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target.GoTo(ThisTransform.up<sp/>*<sp/>(target.stats.Speed<sp/>+<sp/><ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref>));</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//target.rigidbody2D.AddForce(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>ThisTransform.up<sp/>*<sp/>(target.speed<sp/>+<sp/>currentSpeed),<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>ForceMode2D.Force</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"></highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//юнит<sp/>смотрит<sp/>туда<sp/>куда<sp/>и<sp/>отряд</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>(squad.FlipRotation)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>LookTo(squad.PositionsTransform.rotation<sp/>*<sp/>Quaternion.Euler(0,<sp/>0,<sp/>180));</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>LookTo(squad.PositionsTransform.rotation);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1141"><highlight class="normal"></highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//юнит<sp/>смотрит<sp/>туда<sp/>куда<sp/>должен<sp/>смотреть<sp/>отряд</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4566909ad75b23c6326ccfa8cf040058" kindref="member">LookTo</ref>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a71b750c40e090769192c7e2956a20fd4" kindref="member">endLookRotation</ref>);</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"></highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1a8a8338893537fbd6456cb2a8f1717f29" kindref="member">CheckPositionInRange</ref>(<ref refid="class_unit_1ae64583504b6d818650d5b48ab1b26614" kindref="member">TargetMovePositionObject</ref>.transform.position))</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Vector3<sp/>tPos<sp/>=<sp/>TargetMovePositionObject.transform.position<sp/>-<sp/>ThisTransform.position;</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a5613f6d79c066d34ecc77aaf471cd898" kindref="member">GoTo</ref>(tPos.normalized<sp/>*<sp/><ref refid="class_unit_1a634cbff3ef8348517936a486a0796883" kindref="member">CurrentSpeed</ref>);</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"></highlight></codeline>
<codeline lineno="1157" refid="class_unit_1a772f31035a32739ae20bcc424c627f48" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a772f31035a32739ae20bcc424c627f48" kindref="member">MovingInRanks</ref>()</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" kindref="member">Charging</ref>)</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ThisTransform.rotation<sp/>=<sp/><ref refid="class_unit_1abedaa5565c0bd0a48588b931171fd5ae" kindref="member">chargeRotation</ref>;</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a5613f6d79c066d34ecc77aaf471cd898" kindref="member">GoTo</ref>(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.up<sp/>*<sp/><ref refid="class_unit_1a634cbff3ef8348517936a486a0796883" kindref="member">CurrentSpeed</ref>);</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a140aa838eee5afb1fab30a324d822e99" kindref="member">MovingToTarget</ref>();</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1a8a8338893537fbd6456cb2a8f1717f29" kindref="member">CheckPositionInRange</ref>(<ref refid="class_unit_1ae64583504b6d818650d5b48ab1b26614" kindref="member">TargetMovePositionObject</ref>.transform.position))</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4566909ad75b23c6326ccfa8cf040058" kindref="member">LookTo</ref>(<ref refid="class_unit_1ac4e4b283b602538748281cd30747e16e" kindref="member">calcTargetRotations</ref>(<ref refid="class_unit_1ae64583504b6d818650d5b48ab1b26614" kindref="member">TargetMovePositionObject</ref>.transform.position));</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a5613f6d79c066d34ecc77aaf471cd898" kindref="member">GoTo</ref>(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.up<sp/>*<sp/><ref refid="class_unit_1a634cbff3ef8348517936a486a0796883" kindref="member">CurrentSpeed</ref>);</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1ab7b5405903b477d991e77a4ced66a39d" kindref="member">Running</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"></highlight></codeline>
<codeline lineno="1189" refid="class_unit_1ac4e4b283b602538748281cd30747e16e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>Quaternion<sp/><ref refid="class_unit_1ac4e4b283b602538748281cd30747e16e" kindref="member">calcTargetRotations</ref>(Vector3<sp/>targetPosition)</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Quaternion.LookRotation(Vector3.forward,<sp/>targetPosition<sp/>-<sp/>ThisTransform.position);</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"></highlight></codeline>
<codeline lineno="1194" refid="class_unit_1aad6b050d46f2cda7dbd81c1ca2e41353" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aad6b050d46f2cda7dbd81c1ca2e41353" kindref="member">CheckRotationInRange</ref>(Quaternion<sp/>targetRotation)</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Math.Abs(ThisTransform.rotation.eulerAngles.z<sp/>-<sp/>targetRotation.eulerAngles.z)<sp/>&lt;=<sp/><ref refid="class_unit_1ae3bb39d00c9bdf1aaaaca1752dfebbd7" kindref="member">rotationRange</ref>;</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"></highlight></codeline>
<codeline lineno="1199" refid="class_unit_1a8a8338893537fbd6456cb2a8f1717f29" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a8a8338893537fbd6456cb2a8f1717f29" kindref="member">CheckPositionInRange</ref>(Vector3<sp/>targetPosition)</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>movingRangeSqr<sp/>=<sp/><ref refid="class_unit_1a618029083fa135eccf86ff424be8fea5" kindref="member">movingRange</ref><sp/>*<sp/><ref refid="class_unit_1a618029083fa135eccf86ff424be8fea5" kindref="member">movingRange</ref>;</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Vector2.SqrMagnitude(ThisTransform.position<sp/>-<sp/>targetPosition)<sp/>&lt;=<sp/>movingRangeSqr;</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"></highlight></codeline>
<codeline lineno="1205" refid="class_unit_1a5613f6d79c066d34ecc77aaf471cd898" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a5613f6d79c066d34ecc77aaf471cd898" kindref="member">GoTo</ref>(Vector2<sp/>force)</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rigidbody2D.AddForce(force<sp/>*<sp/>rigidbody2D.mass,<sp/>ForceMode2D.Force);</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"></highlight></codeline>
<codeline lineno="1210" refid="class_unit_1a4566909ad75b23c6326ccfa8cf040058" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4566909ad75b23c6326ccfa8cf040058" kindref="member">LookTo</ref>(Quaternion<sp/>lookRotation)</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ThisTransform.rotation<sp/>=<sp/>Quaternion.RotateTowards(ThisTransform.rotation,<sp/>lookRotation,<sp/>stats.RotationSpeed<sp/>*<sp/>Time.deltaTime);</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1215" refid="class_unit_1aee45dbd2a9c87a44be301b708c5e1503" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aee45dbd2a9c87a44be301b708c5e1503" kindref="member">OnPushStart</ref>(Collision2D<sp/>collision)</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null<sp/>&amp;&amp;<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>==<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.RANKS<sp/>&amp;&amp;<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a17079c457a2cd7ba2d4fd936d8c9d17e" kindref="member">InFight</ref>)</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a83d76697cf04cd57be10d0bb1ed5120e" kindref="member">target</ref><sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"></highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(collision.gameObject.layer<sp/>!=<sp/>gameObject.layer)</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"></highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit" kindref="compound">Unit</ref><sp/>collisionUnit<sp/>=<sp/>collision.transform.GetComponent&lt;<ref refid="class_unit" kindref="compound">Unit</ref>&gt;();</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"></highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position<sp/>==<sp/>collisionUnit.<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.position)</highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"></highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//чтоб<sp/>смотрели<sp/>не<sp/>друг<sp/>на<sp/>друга</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>subRot<sp/>=<sp/>Mathf.Abs(ThisTransform.rotation.eulerAngles.z<sp/>-<sp/>collisionUnit.ThisTransform.rotation.eulerAngles.z);</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(subRot<sp/>&gt;=<sp/>180<sp/>-<sp/><ref refid="class_unit_1acee1f097d1eb5b20d4e736cc6afd3195" kindref="member">frontPushingAngleException</ref><sp/>/<sp/>2<sp/>&amp;&amp;<sp/>subRot<sp/>&lt;=<sp/>180<sp/>+<sp/><ref refid="class_unit_1acee1f097d1eb5b20d4e736cc6afd3195" kindref="member">frontPushingAngleException</ref><sp/>/<sp/>2)</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"></highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//чтоб<sp/>коллизия<sp/>была<sp/>спереди</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>rot<sp/>=<sp/>Quaternion.LookRotation(Vector3.forward,<sp/>collisionUnit.ThisTransform.position<sp/>-<sp/>ThisTransform.position).eulerAngles.z;</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>sub<sp/>=<sp/>Mathf.Abs(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation.eulerAngles.z<sp/>-<sp/>rot);</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sub<sp/>&gt;=<sp/><ref refid="class_unit_1ac9f015542720f3afb5115e40dd96bfbe" kindref="member">pushingAngle</ref><sp/>/<sp/>2<sp/>&amp;&amp;<sp/>sub<sp/>&lt;=<sp/>360<sp/>-<sp/><ref refid="class_unit_1ac9f015542720f3afb5115e40dd96bfbe" kindref="member">pushingAngle</ref><sp/>/<sp/>2)</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"></highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//чтоб<sp/>проверить<sp/>что<sp/>this<sp/>находится<sp/>сзади<sp/>коллизии</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>rot2<sp/>=<sp/>Quaternion.LookRotation(Vector3.forward,<sp/>ThisTransform.position<sp/>-<sp/>collisionUnit.ThisTransform.position).eulerAngles.z;</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"></highlight></codeline>
<codeline lineno="1244"><highlight class="normal"></highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//ошибка<sp/>в<sp/>том<sp/>что<sp/>rot2<sp/>&gt;<sp/>rot<sp/>в<sp/>50%<sp/>случаев<sp/>а<sp/>не<sp/>в<sp/>100%</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1246"><highlight class="normal"></highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation.eulerAngles.z<sp/>&gt;=<sp/>180<sp/>&amp;&amp;<sp/>rot<sp/>&lt;<sp/>rot2)</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"></highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation.eulerAngles.z<sp/>&lt;<sp/>180<sp/>&amp;&amp;<sp/>rot<sp/>&gt;<sp/>rot2)</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"></highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" kindref="member">pushingAlly</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rigidbody2D.velocity<sp/>=<sp/>Vector2.zero;</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushedUnit.Add(collisionUnit);</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"></highlight></codeline>
<codeline lineno="1259" refid="class_unit_1afbd20963ecbec94e3afa6e24ea91142a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1afbd20963ecbec94e3afa6e24ea91142a" kindref="member">OnPushEnd</ref>(Collision2D<sp/>collision)</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/>null<sp/>&amp;&amp;<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>.<ref refid="class_squad_1a0e61b22b389bca6483cb8d01a88bba55" kindref="member">CurrentFormation</ref><sp/>==<sp/><ref refid="class_formation_stats" kindref="compound">FormationStats</ref>.<ref refid="class_formation_stats_1ab336466e6a234574db24f2ec914e1dd4" kindref="member">Formations</ref>.RANKS)</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(collision.gameObject.layer<sp/>!=<sp/>gameObject.layer)</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1265"><highlight class="normal"></highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit" kindref="compound">Unit</ref><sp/>collisionUnit<sp/>=<sp/>collision.transform.GetComponent&lt;<ref refid="class_unit" kindref="compound">Unit</ref>&gt;();</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="class_unit_1a46fef034c97d6f9f17679d02bc1c9690" kindref="member">pushedUnit</ref>.Contains(collisionUnit))</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1270"><highlight class="normal"></highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushedUnit.Remove(collisionUnit);</highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a46fef034c97d6f9f17679d02bc1c9690" kindref="member">pushedUnit</ref>.Count<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"></highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a93cdc599aa3a1f72faccfc235b2931d7" kindref="member">olreadyNotPushingAlly</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"></highlight></codeline>
<codeline lineno="1279" refid="class_unit_1aef944e12d8ee536f06a044aee4845ba2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1aef944e12d8ee536f06a044aee4845ba2" kindref="member">OnChargeHit</ref>(Collision2D<sp/>collision)</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>k<sp/>=<sp/><ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref><sp/>/<sp/>stats.Speed;</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k<sp/>=<sp/>k<sp/>&gt;<sp/>1<sp/>?<sp/>1<sp/>:<sp/>k;</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(collision.gameObject.layer<sp/>==<sp/>LayerMask.NameToLayer(</highlight><highlight class="stringliteral">&quot;MAP&quot;</highlight><highlight class="normal">)<sp/>||<sp/>collision.gameObject.layer<sp/>==<sp/>LayerMask.NameToLayer(</highlight><highlight class="stringliteral">&quot;WALL&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dmg<sp/>=<sp/>k<sp/>*<sp/>weapon.Stats.Damag.BaseDamage;</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4d5cde8815a3a4755e2d30b23bd52b36" kindref="member">TakeDamage</ref>(dmg,<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>);</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit" kindref="compound">Unit</ref><sp/>unit<sp/>=<sp/>collision.transform.GetComponent&lt;<ref refid="class_unit" kindref="compound">Unit</ref>&gt;();</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(unit<sp/>!=<sp/>null)</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//чтоб<sp/>коллизия<sp/>была<sp/>спереди</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>rot<sp/>=<sp/>Quaternion.LookRotation(Vector3.forward,<sp/>unit.ThisTransform.position<sp/>-<sp/>ThisTransform.position).eulerAngles.z;</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>sub<sp/>=<sp/>Mathf.Abs(<ref refid="class_unit_1ad59d6561ce9d20705d2179680fddb15f" kindref="member">ThisTransform</ref>.rotation.eulerAngles.z<sp/>-<sp/>rot);</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sub<sp/>&gt;=<sp/><ref refid="class_unit_1a6e26511ceba3f6e0734bd926eb387abe" kindref="member">chargePpushingAngle</ref><sp/>/<sp/>2<sp/>&amp;&amp;<sp/>sub<sp/>&lt;=<sp/>360<sp/>-<sp/><ref refid="class_unit_1a6e26511ceba3f6e0734bd926eb387abe" kindref="member">chargePpushingAngle</ref><sp/>/<sp/>2)</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//союзники</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(unit.gameObject.layer<sp/>==<sp/>gameObject.layer)</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(unit.<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>!=<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref><sp/>||<sp/>!unit.<ref refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" kindref="member">Charging</ref>)</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a99340fb487dc77c1913ea1c268a71714" kindref="member">TakeStan</ref>(k);</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//враги<sp/>и<sp/>нейтралы</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>impact<sp/>=<sp/>stats.ChargeImpact<sp/>-<sp/>unit.stats.ChargeDeflect;</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">float</highlight><highlight class="normal"><sp/>dmg<sp/>=<sp/>stats.Damage.BaseDamage<sp/>*<sp/>stats.UnitChargeAddDamage<sp/>*<sp/>impact<sp/>*<sp/>k;</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>=<sp/>dmg<sp/>&lt;<sp/>0<sp/>?<sp/>-dmg<sp/>:<sp/>dmg;</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>-=<sp/>unit.stats.Armour;</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dmg<sp/>&lt;<sp/><ref refid="class_unit_1a2963b9f9aa20a262e582486e9ac5e1b5" kindref="member">stats</ref>.<ref refid="struct_unit_stats_1a92c336291a7a1dec8f1291fdca796bdc" kindref="member">Damage</ref>.<ref refid="struct_damage_1a540de67f1528f23cc0c61d1bcc3f6143" kindref="member">ArmourDamage</ref>)</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dmg<sp/>=<sp/>stats.Damage.ArmourDamage;</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(impact<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//тут<sp/>надо<sp/>правильно<sp/>рассчитать<sp/>силу<sp/>импульса</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unit.GoTo(ThisTransform.up<sp/>*<sp/>(impact<sp/>*<sp/><ref refid="class_unit_1a4a4e45d4614bc6b5e297b7c60dbbee75" kindref="member">currentSpeed</ref>)<sp/>/<sp/>Time.deltaTime<sp/>/<sp/>5);</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unit.TakeDamage(dmg,<sp/><ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unit.gameObject.layer<sp/>=<sp/>LayerMask.NameToLayer(</highlight><highlight class="stringliteral">&quot;FALLEN_UNIT&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(impact<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1a4d5cde8815a3a4755e2d30b23bd52b36" kindref="member">TakeDamage</ref>(dmg,<sp/>unit.<ref refid="class_unit_1ab444f32bca1bbd2f36dab3b9cd604080" kindref="member">squad</ref>,<sp/>unit);</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"></highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//if<sp/>(rigidbody2D.velocity.sqrMagnitude<sp/>&lt;<sp/>7)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" kindref="member">Charging</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"></highlight></codeline>
<codeline lineno="1338" refid="class_unit_1ae592e3ea0e332fb55b95d7b5f445b396" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1ae592e3ea0e332fb55b95d7b5f445b396" kindref="member">OnCollisionEnter2D</ref>(Collision2D<sp/>collision)</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aee45dbd2a9c87a44be301b708c5e1503" kindref="member">OnPushStart</ref>(collision);</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"></highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1aca9289f3a877a9f051ddb2fb2c560a56" kindref="member">Charging</ref>)</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1aef944e12d8ee536f06a044aee4845ba2" kindref="member">OnChargeHit</ref>(collision);</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"></highlight></codeline>
<codeline lineno="1346" refid="class_unit_1a8acb4f4799b1ceb8d06c2e025471d614" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a8acb4f4799b1ceb8d06c2e025471d614" kindref="member">OnCollisionExit2D</ref>(Collision2D<sp/>collision)</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="class_unit_1afbd20963ecbec94e3afa6e24ea91142a" kindref="member">OnPushEnd</ref>(collision);</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"></highlight></codeline>
<codeline lineno="1351" refid="class_unit_1a4807d171db1235280c8dcbcb12f623e1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="class_unit_1a4807d171db1235280c8dcbcb12f623e1" kindref="member">OnDrawGizmos</ref>()</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.color<sp/>=<sp/>Color.white;</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.DrawLine(ThisTransform.position,<sp/>startRay.position);</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"></highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.color<sp/>=<sp/>Color.blue;</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.DrawLine(startRay.position,<sp/>endRay.position);</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"></highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.color<sp/>=<sp/>Color.yellow;</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a08525dd59d7fb034cf0343c9e154fb20" kindref="member">pushingAlly</ref>)</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.DrawSphere(ThisTransform.position,<sp/>0.4f);</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"></highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.color<sp/>=<sp/>Color.gray;</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a95573f5c0d7610e5ef074df6c2684131" kindref="member">targettedBy</ref>.Count<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.DrawSphere(ThisTransform.position,<sp/>0.3f);</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"></highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.color<sp/>=<sp/>Color.blue;</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a5f06967732cecb0a195a9e0085f752a6" kindref="member">attaking</ref>)</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.DrawSphere(ThisTransform.position,<sp/>0.2f);</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"></highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.color<sp/>=<sp/>Color.red;</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="class_unit_1a4cdd3a4daad8ee4c5f1d50639697a79f" kindref="member">stanned</ref>)</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gizmos.DrawSphere(ThisTransform.position,<sp/>0.1f);</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"></highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//for<sp/>debug</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//private<sp/>void<sp/>OnMouseDown()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>Health<sp/>-=<sp/>10;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1381"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="D:/development/unity/mytestgame/MyTestGameProject/Assets/Scripts/main_scene/Unit/Unit.cs"/>
  </compounddef>
</doxygen>
